<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="script-src 'self' 'unsafe-inline';">
    <title>Writly</title>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400|Roboto:400" rel="stylesheet">
    <style>
        body, html {
            height: 100%;
            margin: 0;
            padding: 0;
            overflow: hidden;
            background-color: #F2F0EC;
            -webkit-app-region: drag;
        }

        body {
            font-family: 'Roboto', sans-serif;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            padding-top: 28px; /* Ajusté pour la barre de titre native macOS */
            overflow: hidden; /* Garder le body sans défilement */
        }

        /* Suppression des styles des boutons de fenêtre personnalisés */
        .window-controls {
            display: none;
        }

        /* Ajout des contrôles de fenêtre */
        .window-controls {
            position: fixed;
            top: 8px;
            left: 10px;
            display: flex;
            gap: 6px;
            z-index: 1000;
            background: transparent;
            padding: 4px;
            border-radius: 12px;
        }

        .window-control {
            width: 14px;
            height: 14px;
            border-radius: 50%;
            cursor: pointer;
            transition: opacity 0.3s;
            margin: 0 4px;
        }

        .window-control:hover {
            opacity: 0.8;
        }

        .close-window {
            background-color: #ff5f57;
            order: 1;
        }

        .minimize-window {
            background-color: #febc2e;
            order: 2;
        }

        .maximize-window {
            background-color: #28c840;
            order: 3;
        }

        /* Modification du conteneur principal */
        .main-container {
            width: 100%;
            height: 100vh;
            -webkit-app-region: drag;
            background-color: transparent;
            overflow: auto; /* Permettre le défilement uniquement sur le conteneur principal */
        }

        .linkedin-layout {
            display: flex;
            justify-content: center;
            max-width: 1128px;
            margin: 0 auto;
            padding: 54px 0;
            padding-top: 32px;
            height: auto;
            overflow-y: hidden; /* Empêcher le défilement vertical dans ce conteneur */
            max-height: none;
        }

        /* Tous les éléments interactifs ne doivent pas être draggable */
        button, 
        input, 
        textarea, 
        .style-buttons, 
        .settings-icon, 
        .theme-toggle,
        .window-controls,
        #text-area,
        .linkedin-post,
        .modal,
        .settings-modal,
        a,
        select,
        .style-button,
        .share-button,
        #image-preview,
        #regenerate-image {
            -webkit-app-region: no-drag;
        }

        .container {
            display: flex;
            position: relative;
            max-width: 100%;
            padding: 20px;
            box-sizing: border-box;
        }

        .linkedin-post {
            width: 555px;
            max-width: 100%;
            background: #ffffff;
            color: #000;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            overflow: hidden;
            position: relative;
            padding: 0;
        }

        #text-area {
            min-height: 100px;
            width: 100%;
            border: none;
            outline: none;
            font-size: 16px;
            line-height: 1.5;
            padding: 16px;
            padding-bottom: 0px;
            box-sizing: border-box;
            white-space: pre-wrap;
            word-wrap: break-word;
            color: #000000; /* Couleur noire sans !important pour permettre l'override */
        }

        body.dark-mode #text-area {
            color: #e0e0e0; /* Couleur claire pour le mode sombre */
        }

        #text-area[data-placeholder]:empty:before {
            content: attr(data-placeholder);
            color: #999; /* Gris clair pour le placeholder */
            font-style: italic;
            position: absolute;
            pointer-events: none;
            white-space: pre-wrap;
        }

        body.dark-mode #text-area[data-placeholder]:empty:before {
            color: #777; /* Gris plus clair pour le placeholder en mode sombre */
        }

        #text-area.placeholder-active {
            color: #999; /* Gris clair pour le placeholder */
            font-style: italic;
        }

        body.dark-mode #text-area.placeholder-active {
            color: #777; /* Gris plus clair pour le placeholder en mode sombre */
        }

        #text-area:focus[data-placeholder]:empty:before {
            content: "";
        }

        #text-area strong {
            font-weight: 700;
        }
        #text-area br {
            display: block;
            content: "";
            margin-top: 10px;
        }
        .dud {
            color: #0A66C2; /* Bleu LinkedIn */
        }
        .settings-icon {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            -webkit-app-region: no-drag;
            transition: transform 0.2s ease;
        }

        .theme-toggle {
            position: fixed;
            top: 20px;
            right: 70px; /* Positionné à côté de l'icône des paramètres */
            background: white;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            -webkit-app-region: no-drag;
            transition: transform 0.2s ease;
        }

        .theme-icon {
            width: 24px;
            height: 24px;
            color: #555;
        }

        .settings-icon:hover, .theme-toggle:hover, .collapse-icon:hover {
            transform: scale(1.05);
            opacity: 1;
        }

        body.dark-mode .settings-icon, 
        body.dark-mode .theme-toggle,
        body.dark-mode .collapse-icon {
            background: #333;
        }

        body.dark-mode .theme-icon, 
        body.dark-mode .settings-icon svg,
        body.dark-mode .collapse-icon svg {
            color: #eee;
        }


        body.dark-mode .theme-toggle svg {
            width: 24px;
            height: 24px;
            color: #555;
        }

        .theme-toggle.light-icon {
            background-color: white;
        }

        .theme-toggle.dark-icon {
            background-color: #333;
        }

        .theme-toggle.light-icon svg {
            color: #555;
        }

        .theme-toggle.dark-icon svg {
            color: #f0f0f0;
        }

        .theme-circle {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .theme-circle:hover {
            transform: scale(1.1);
        }

        .light-theme {
            background-color: #f5f5f5;
            border: 2px solid #ddd;
        }

        .dark-theme {
            background-color: #333;
            border: 2px solid #666;
        }

        body.dark-mode .settings-icon,
        body.dark-mode .theme-toggle {
            background-color: #333;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        body.dark-mode .settings-icon svg {
            color: rgba(255, 255, 255, 0.8);
        }

        body.dark-mode .light-theme {
            background-color: #f5f5f5;
            border-color: #999;
        }

        body.dark-mode .dark-theme {
            background-color: #111;
            border-color: #999;
        }

 @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

.regenerate-icon.spinning {
    animation: spin 1s linear infinite;
}

        /* Style amélioré pour la modale des paramètres - Style LinkedIn */
        .settings-modal {
            display: none;
            position: fixed;
            z-index: 1001;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(3px);
            animation: fadeIn 0.2s ease;
        }

        .settings-content {
            background-color: #fff;
            margin: 5% auto;
            padding: 24px;
            border-radius: 8px;
            width: 85%;
            max-width: 800px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            animation: slideIn 0.2s ease;
            position: relative;
        }

        .settings-topbar {
            position: sticky;
            top: 0;
            background-color: #fff;
            padding: 16px 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #e0e0e0;
            margin: -24px -24px 24px -24px;
            border-radius: 8px 8px 0 0;
        }

        body.dark-mode .settings-topbar {
            background-color: #1E1E1E;
            border-bottom-color: #333;
        }

        .settings-topbar h2 {
            margin: 0;
            padding: 0;
        }

        .settings-topbar-right {
            display: flex;
            align-items: center;
            gap: 24px; /* Augmentation de l'espacement entre les boutons */
        }

        .settings-content button.topbar-save {
            margin: 0;
            margin-right: 8px; /* Ajout d'une marge à droite du bouton Sauvegarder */
        }

        body.dark-mode .settings-content {
            background-color: #1E1E1E;
            color: #f0f0f0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .settings-content h2 {
            color: rgba(0, 0, 0, 0.9);
            margin-top: 0;
            margin-bottom: 20px;
            font-size: 20px;
            font-weight: 600;
            border-bottom: none;
            padding-bottom: 0;
        }

        body.dark-mode .settings-content h2 {
            color: rgba(255, 255, 255, 0.9);
        }

        .settings-content h3 {
            color: rgba(0, 0, 0, 0.9);
            margin-top: 24px;
            margin-bottom: 12px;
            font-size: 16px;
            font-weight: 600;
            border-bottom: none;
            padding-bottom: 0;
        }

        body.dark-mode .settings-content h3 {
            color: rgba(255, 255, 255, 0.9);
        }

        .settings-content label {
            display: block;
            margin-top: 16px;
            margin-bottom: 4px;
            font-weight: 500;
            font-size: 14px;
            color: rgba(0, 0, 0, 0.6);
        }

        body.dark-mode .settings-content label {
            color: rgba(255, 255, 255, 0.6);
        }

        .settings-content input[type="text"],
        .settings-content textarea,
        .settings-content select {
            width: 100%;
            padding: 10px 12px;
            margin-bottom: 12px;
            border: 1px solid rgba(0, 0, 0, 0.15);
            border-radius: 4px;
            font-size: 14px;
            transition: all 0.2s ease;
            box-sizing: border-box;
        }

        .settings-content input[type="text"]:focus,
        .settings-content textarea:focus,
        .settings-content select:focus {
            border-color: #0a66c2;
            outline: none;
            box-shadow: 0 0 0 1px #0a66c2;
        }

        body.dark-mode .settings-content input[type="text"],
        body.dark-mode .settings-content textarea,
        body.dark-mode .settings-content select {
            background-color: #2c2c2c;
            border-color: rgba(255, 255, 255, 0.15);
            color: #f0f0f0;
        }

        .settings-content textarea {
            min-height: 80px;
            resize: vertical;
        }

        .close-button {
            position: relative; /* Changement de position: absolute à relative */
            top: auto;
            right: auto;
            color: rgba(0, 0, 0, 0.6);
            font-size: 24px;
            font-weight: normal;
            cursor: pointer;
            transition: color 0.2s ease;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }

        .close-button:hover {
            color: rgba(0, 0, 0, 0.9);
            background-color: rgba(0, 0, 0, 0.08);
        }

        body.dark-mode .close-button {
            color: rgba(255, 255, 255, 0.6);
        }

        body.dark-mode .close-button:hover {
            color: rgba(255, 255, 255, 0.9);
            background-color: rgba(255, 255, 255, 0.08);
        }

        .option-setting {
            margin: 12px 0;
            padding: 12px;
            background-color: rgba(0, 0, 0, 0.02);
            border-radius: 4px;
            border: 1px solid rgba(0, 0, 0, 0.08);
        }

        body.dark-mode .option-setting {
            background-color: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.08);
        }

        .option-setting label {
            display: flex;
            align-items: center;
            margin: 0;
            cursor: pointer;
            font-weight: normal;
        }

        .option-setting input[type="checkbox"] {
            margin-right: 8px;
            width: 16px;
            height: 16px;
            accent-color: #0a66c2;
        }

        #button-settings {
            display: flex;
            flex-direction: column;
            gap: 16px;
            margin-top: 12px;
            width: 100%;
        }

        .button-setting {
            background-color: rgba(0, 0, 0, 0.02);
            padding: 16px;
            border-radius: 4px;
            border: 1px solid rgba(0, 0, 0, 0.08);
            width: 100%;
            box-sizing: border-box;
        }

        body.dark-mode .button-setting {
            background-color: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.08);
        }

        .button-setting textarea {
            width: 100%;
        }

        .settings-content button {
            background-color: #0a66c2;
            color: white;
            border: none;
            border-radius: 24px;
            padding: 8px 24px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 20px;
            transition: background-color 0.2s ease;
        }

        .settings-content button:hover {
            background-color: #004182;
        }

        body.dark-mode .settings-content button {
            background-color: #0a66c2;
        }

        body.dark-mode .settings-content button:hover {
            background-color: #0d76e0;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideIn {
            from { transform: translateY(-10px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .side-buttons {
            position: absolute;
            left: -150px;
            top: 20px; /* Ajusté pour correspondre au padding du conteneur */
            display: flex;
            flex-direction: column;
            gap: 15px;
            z-index: 10;
        }
        .side-button {
            padding: 12px 15px;
            background-color: #ffffff;
            color: #000;
            border: none;
            border-color: #888;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 130px;
            text-align: center;
            font-family: 'Roboto', sans-serif;
            font-size: 14px;
            font-weight: 500;
            letter-spacing: 0.5px;
            border-radius: 8px;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .side-button.erase {
            background-color: #ff4d4d;
            color: #ffffff;
        }
        .side-button:hover {
            background-color: #ffffff;
            transform: translateX(5px);
            box-shadow: 0 2px 4px rgba(0,0,0,0.15);
        }
        .side-button.erase:hover {
            background-color: #ff3333;
        }
        #text-area::placeholder {
            color: #999; /* Gris clair pour le placeholder */
            font-style: italic;
        }
        #text-area[data-placeholder-active="true"] {
            color: #999; /* Gris clair pour le placeholder */
            font-style: italic;
        }
        .post-footer {
            margin-top: 0; /* Supprime la marge supérieure */
            padding-top: 0; /* Supprime le padding supérieur */
        }
        .footer-image {
            width: 100%;
            height: auto;
            display: block;
        }
        .post-header {
            display: flex;
            align-items: center;
            padding: 12px 16px;
        }
        .avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            margin-right: 12px;
        }
        .user-info {
            display: flex;
            flex-direction: column;
        }
        .user-name {
            font-size: 16px;
            font-weight: 500;
            margin: 0;
        }
        .user-title {
            font-size: 14px;
            color: #666;
            margin: 2px 0;
        }
        .post-time {
            font-size: 12px;
            color: #666;
            margin: 0;
        }
        .globe-icon {
            font-size: 12px;
        }
        .interaction-buttons {
            display: flex;
            justify-content: space-between;
            padding: 4px 0;
        }

        .interaction-buttons button {
            background: none;
            border: none;
            color: #666;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            padding: 8px 12px;
            border-radius: 4px;
            transition: background-color 0.2s;
        }

        .interaction-buttons button:hover {
            background-color: rgba(0, 0, 0, 0.05);
        }

        .interaction-buttons .icon {
            margin-right: 8px;
            font-size: 18px;
        }
        #image-preview {
            max-width: 555px;
            width: 100%;
            margin-top: 8px; /* Réduire la marge supérieure */
            display: none;
            padding: 0 16px;
            box-sizing: border-box;
        }

        #image-preview img {
            position: relative;

    width: 100%;
    margin-top: 8px;
    display: none;
    box-sizing: border-box;
        }

        @media (max-height: 700px) {
            body {
                padding-top: 20px;
            }
        }

        /* Style amélioré pour le bouton de régénération */
        #regenerate-image {
            position: absolute;
            top: 10px;
            right: 26px;
            background-color: rgba(255, 255, 255, 0.9);
            border: 2px solid #0077B5;
            border-radius: 50%;
            padding: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10;
        }

        #regenerate-image:hover {
            background-color: #0077B5;
        }

        #regenerate-image:active {
            transform: scale(0.95);
        }

        #regenerate-image svg {
            width: 20px;
            height: 20px;
            color: #0077B5;
            transition: color 0.2s ease;
        }

        #regenerate-image:hover svg {
            color: white;
        }

        #regenerate-image.loading {
            opacity: 0.7;
            pointer-events: none;
        }

        /* Style pour le mode sombre */
        body.dark-mode #regenerate-image {
            background-color: rgba(45, 45, 45, 0.9);
            border-color: #0a66c2;
        }

        body.dark-mode #regenerate-image svg {
            color: #0a66c2;
        }

        body.dark-mode #regenerate-image:hover {
            background-color: #0a66c2;
        }

        body.dark-mode #regenerate-image:hover svg {
            color: #ffffff;
        }

        /* Tooltip pour le bouton de régénération */
        #regenerate-image::after {
            content: "Régénérer l'image";
            position: absolute;
            bottom: -30px;
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.2s ease;
        }

        #regenerate-image:hover::after {
            opacity: 1;
            visibility: visible;
        }

        /* Animation de feedback lors de la régénération */
        @keyframes regenerate-pulse {
            0% { transform: scale(1) rotate(0deg); }
            50% { transform: scale(1.1) rotate(180deg); }
            100% { transform: scale(1) rotate(360deg); }
        }

        #regenerate-image.regenerating {
            animation: regenerate-pulse 1s ease;
        }

        /* Style pour le nouveau bouton de partage */
        .share-button {
            display: none; /* Cacher le bouton par défaut */
            width: calc(100% - 32px);
            margin: 16px;
            padding: 12px;
            background-color: #0077B5;
            color: white;
            border: none;
            border-radius: 24px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .share-button:hover {
            background-color: #005e93;
            transform: translateY(-2px);
        }

        .share-button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
            transform: none;
        }

        .share-button.translating {
            position: relative;
            color: transparent;
        }

        .share-button.translating::after {
            content: "";
            position: absolute;
            left: 50%;
            top: 50%;
            width: 20px;
            height: 20px;
            border: 2px solid #ffffff;
            border-radius: 50%;
            border-top-color: transparent;
            animation: spin 1s linear infinite;
            transform: translate(-50%, -50%);
        }

        @keyframes spin {
            to {
                transform: translate(-50%, -50%) rotate(360deg);
            }
        }

        /* Ajustez la marge inférieure du text-area si nécessaire */
        #text-area {
            margin-bottom: 0px;
        }

        /* Ajustez la marge supérieure de l'aperçu d'image si nécessaire */
        #image-preview {
            margin-top: 8px;
        }

        /* Styles pour la modal */
        .modal {
            display: none;
            position: fixed;
            z-index: 1;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.4);
        }

        .modal-content {
            background-color: #fefefe;
            margin: 15% auto;
            padding: 20px;
            border: 1px solid #888;
            width: 80%;
            max-width: 600px;
        }

        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
        }

        .close:hover,
        .close:focus {
            color: black;
            text-decoration: none;
            cursor: pointer;
        }

        #scriptArea {
            width: 100%;
            height: 100px;
            margin-top: 10px;
        }

        #copyScript {
            margin-top: 10px;
        }

        @keyframes glitch-anim {
            0% {
                clip: rect(31px, 9999px, 94px, 0);
                transform: skew(0.85deg);
            }
            5% {
                clip: rect(70px, 9999px, 71px, 0);
                transform: skew(0.17deg);
            }
            /* ... autres étapes de l'animation ... */
            100% {
                clip: rect(67px, 9999px, 18px, 0);
                transform: skew(0.2deg);
            }
        }

        .style-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin: 16px;
        }

        .style-button {
            background-color: transparent;
            border: 1px solid #0077B5;
            color: #0077B5;
            border-radius: 16px;
            padding: 6px 12px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        .style-button:hover {
            background-color: rgba(0, 119, 181, 0.1);
        }

        .style-button:active {
            background-color: #0077B5;
            color: white;
        }

        .style-button.erase {
            border-color: #ff4d4d;
            color: #ff4d4d;
        }

        .style-button.erase:hover {
            background-color: rgba(255, 77, 77, 0.1);
        }

        .style-button.erase:active {
            background-color: #ff4d4d;
            color: white;
        }

        /* Ajustez le style du bouton de partage si ncessaire */
        .share-button {
            margin-top: 8px;
        }

        /* Assurez-vous que le text-area a une marge inférieure appropriée */
        #text-area {
            margin-bottom: 0px;
        }

        .linkedin-topbar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 52px;
            background-color: #ffffff;
            border-bottom: 1px solid #e0e0e0;
            z-index: 100;
            /* La ligne suivante a été supprimée :
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
            */
        }

        /* Ajustez le padding-top du body pour compenser la hauteur de la topbar */
        body {
            padding-top: 52px;
        }

        /* Ajustez la position du conteneur principal si nécessaire */
        .container {
            position: relative;
            z-index: 1;
        }

        body {
            background-color: #f3f2ef;
            margin: 0;
            padding-top: 52px; /* Pour la barre supérieure */
            font-family: -apple-system, system-ui, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', 'Fira Sans', Ubuntu, Oxygen, 'Oxygen Sans', Cantarell, 'Droid Sans', 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Lucida Grande', Helvetica, Arial, sans-serif;
        }

        .left-column, .main-column, .right-column {
            width: 225px;
            margin: 0 12px;
            height: auto;
            overflow-y: hidden; /* Empêcher le défilement vertical dans les colonnes */
        overflow-x: hidden;
        }

        .main-column {
            width: 555px;
            margin: 0 12px;
        }

        .profile-card, .dashboard-card, .news-card, .ad-card {
            background-color: #fff;
            border-radius: 8px;
            border: 1px solid #e0e0e0;
            margin-bottom: 8px;
        }

        .profile-card {
            height: 300px;
        }

        .dashboard-card {
            height: 150px;
        }

        .news-card {
            height: 400px;
        }

        .ad-card {
            height: 200px;
        }

        .linkedin-post {
            background-color: #fff;
            border-radius: 8px;
            border: 1px solid #e0e0e0;
            overflow: hidden;
        }

        @media (max-width: 1024px) {
            .linkedin-layout {
                flex-wrap: wrap;
            }

            .left-column, .right-column {
                display: none;
            }

            .main-column {
                width: 100%;
                max-width: 555px;
            }
        }

        .credit {
            text-align: center;
            font-size: 12px;
            color: #00000040;
            margin-top: 8px;
            font-family: 'Roboto', sans-serif;
            font-weight: 400;
        }

        .black-text {
            color: #000000 !important;
        }

        body.dark-mode .black-text {
            color: #e0e0e0 !important;
        }

        @keyframes effacement-texte {
            from { opacity: 1; }
            to { opacity: 0; }
        }

        .effacer-animation {
            animation: effacement-texte 1s forwards;
        }

        @keyframes clignotement {
            0% { opacity: 1; }
            50% { opacity: 0; }
            100% { opacity: 1; }
        }

        .effet-clignotement {
            animation: clignotement 0.5s 3;
        }

        .top-bar {
            background-color: white;
            color: rgba(0, 0, 0, 0.9);
            padding: 0;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 52px;
            z-index: 1000;
            border-bottom: 1px solid rgba(0, 0, 0, 0.08);
            box-shadow: 0 4px 20px -5px rgba(243, 242, 239, 0.8); /* Ajout d'une ombre portée pour créer l'effet de transition */
        }

        .top-bar-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1128px;
            margin: 0 auto;
            padding: 0 20px;
            height: 52px;
        }

        .left-section, .right-section {
            flex: 1;
        }

        .app-name {
            font-size: 20px;
            font-weight: 600;
            flex: 2;
            text-align: center;
            color: #0a66c2;
        }

        .settings-icon {
            cursor: pointer;
            font-size: 20px;
            display: flex;
            justify-content: flex-end;
        }

        body {
            padding-top: 52px;
        }

        /* ... autres styles ... */

        .credit {
            text-align: center;
            font-size: 12px;
            color: #00000040;
            margin-top: 8px;
            font-family: 'Roboto', sans-serif;
            font-weight: 400;
        }

        .settings-link {
            color: #0a66c2;
            text-decoration: none;
            font-size: 12px;
            margin-top: 4px;
            display: inline-block;
        }

        .settings-link:hover {
            text-decoration: underline;
        }

        /* ... autres styles ... */
        .credit a {
            color: inherit; /* Utilise la même couleur que le texte environnant */
            text-decoration: underline; /* Souligne le lien */
        }

        body.dark-mode {
            background-color: #121212;
            color: #e0e0e0; /* Texte plus clair pour une meilleure lisibilité */
        }

        body.dark-mode .linkedin-post {
            background-color: #1e1e1e;
            color: #e0e0e0; /* Texte plus clair pour une meilleure lisibilité */
            border-color: #333;
        }

        body.dark-mode .settings-content {
            background-color: #2c2c2c;
            color: #ffffff;
            border-color: #444;
        }

        body.dark-mode .settings-content input,
        body.dark-mode .settings-content textarea,
        body.dark-mode .settings-content select {
            background-color: #3c3c3c;
            color: #ffffff;
            border-color: #555;
        }

        body.dark-mode .settings-content button {
            background-color: #4CAF50;
            color: white;
        }

        body.dark-mode .settings-content button:hover {
            background-color: #45a049;
        }

        body.dark-mode .top-bar {
            background-color: #1e1e1e;
            border-bottom-color: #333;
            box-shadow: 0 4px 20px -5px rgba(0, 0, 0, 0.5); /* Ombre plus sombre et subtile */
            color: #e0e0e0;
        }

        body.dark-mode .top-bar-content {
            color: #e0e0e0;
        }

        body.dark-mode .app-name {
            color: #4d9eea; /* Bleu plus clair pour le mode sombre */
        }

        body.dark-mode .credit {
            color: #ffffff;
        }

        body.dark-mode .credit a {
            color: #0a66c2;
        }

        body.dark-mode .style-button {
            border-color: #ffffff;
            color: #ffffff;
        }

        body.dark-mode .style-button:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }

        body.dark-mode .style-button.erase {
            border-color: #ff4d4d;
            color: #ff4d4d;
        }

        body.dark-mode .style-button.erase:hover {
            background-color: rgba(255, 77, 77, 0.1);
        }

        body.dark-mode .share-button {
            background-color: #0a66c2;
            color: #ffffff;
        }

        body.dark-mode .share-button:hover {
            background-color: #005e93;
        }

        body.dark-mode .left-column, 
        body.dark-mode .right-column, 
        body.dark-mode .main-column {
            background-color: transparent; /* Fond transparent */
            color: #e0e0e0; /* Gris très clair pour une meilleure lisibilité */
        }

        body.dark-mode .profile-card, 
        body.dark-mode .dashboard-card, 
        body.dark-mode .news-card, 
        body.dark-mode .ad-card {
            background-color: #1e1e1e; /* Fond sombre pour les cartes */
            border-color: #333; /* Bordure plus visible */
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3); /* Ombre plus prononcée */
        }

        body.dark-mode .settings-icon svg {
            fill: #ffffff; /* Change la couleur de l'icône des paramètres en blanc */
        }

        /* Ajout du style pour la barre de titre native Mac */
        .top-bar {
            -webkit-app-region: drag;
            padding-top: 28px; /* Espace pour la barre de titre native */
        }
        
        .settings-icon, .theme-toggle, .style-buttons button {
            -webkit-app-region: no-drag;
        }

        /* Zones draggables */
        .draggable-area {
            -webkit-app-region: drag;
        }

        /* Ajuster les marges et le padding du conteneur principal */
        .main-container {
            width: 100%;
            height: 100vh;
            -webkit-app-region: drag;
            background-color: transparent;
            overflow: auto;
        }

        /* Ajuster les colonnes latérales pour quelles soient draggables */
        .left-column, 
        .right-column {
            -webkit-app-region: drag;
            background-color: transparent;
        }

        /* Rendre la zone de post non-draggable */
        .linkedin-post {
            -webkit-app-region: no-drag;
            position: relative;
            z-index: 1;
        }

        /* Ajouter une zone draggable en haut du post */
        .post-header {
            -webkit-app-region: drag;
            padding: 12px 16px;
            background-color: white;
        }

        body.dark-mode .post-header {
            background-color: #1e1e1e;
            color: #e0e0e0;
        }

        /* S'assurer que les éléments interactifs dans le header ne sont pas draggables */
        .post-header img,
        .post-header .user-info {
            -webkit-app-region: no-drag;
        }

        /* Ajuster le style des boutons de contrôle */
        .window-controls {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(5px);
            padding: 6px;
            border-radius: 12px;
        }

        /* Ajout des styles pour le bouton de génération d'image */
        #generateImageButton {
            margin-top: 8px;
            background-color: #28a745;
        }

        #generateImageButton:hover {
            background-color: #218838;
        }

        #generateImageButton.generating {
            position: relative;
            color: transparent;
        }

        #generateImageButton.generating::after {
            content: "";
            position: absolute;
            left: 50%;
            top: 50%;
            width: 20px;
            height: 20px;
            border: 2px solid #ffffff;
            border-radius: 50%;
            border-top-color: transparent;
            animation: spin 1s linear infinite;
            transform: translate(-50%, -50%);
        }

        /* Ajout du style pour le bouton de génération d'image */
        .generate-image-button {
            display: none;
            width: calc(100% - 32px);
            margin: 8px 16px;
            padding: 12px;
            background-color: #34a853;
            color: white;
            border: none;
            border-radius: 24px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .generate-image-button:hover {
            background-color: #2d9147;
            transform: translateY(-2px);
        }

        .generate-image-button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
            transform: none;
        }

        .generate-image-button.generating {
            position: relative;
            color: transparent;
        }

        .generate-image-button.generating::after {
            content: "";
            position: absolute;
            left: 50%;
            top: 50%;
            width: 20px;
            height: 20px;
            border: 2px solid #ffffff;
            border-radius: 50%;
            border-top-color: transparent;
            animation: spin 1s linear infinite;
            transform: translate(-50%, -50%);
        }

        /* Modification du style des boutons pour les rendre plus discrets */
        .share-button, .generate-image-button {
            display: none;
            width: auto;
            margin: 8px 16px;
            padding: 8px 16px;
            background-color: transparent;
            color: #0077B5;
            border: 1px solid #0077B5;
            border-radius: 16px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            text-align: center;
        }

        .share-button:hover, .generate-image-button:hover {
            background-color: rgba(0, 119, 181, 0.1);
            transform: translateY(-1px);
        }

        .share-button:disabled, .generate-image-button:disabled {
            border-color: #cccccc;
            color: #cccccc;
            cursor: not-allowed;
            transform: none;
        }

        /* Style spécifique pour le bouton de génération d'image */
        .generate-image-button {
            color: #34a853;
            border-color: #34a853;
        }

        .generate-image-button:hover {
            background-color: rgba(52, 168, 83, 0.1);
        }

        /* Style pour les boutons en mode sombre */
        body.dark-mode .share-button, 
        body.dark-mode .generate-image-button {
            background-color: transparent;
            color: #0a66c2;
            border-color: #0a66c2;
        }

        body.dark-mode .generate-image-button {
            color: #34a853;
            border-color: #34a853;
        }

        /* Style pour les états de chargement */
        .share-button.translating, 
        .generate-image-button.generating {
            position: relative;
            color: transparent !important;
        }

        .share-button.translating::after, 
        .generate-image-button.generating::after {
            content: "";
            position: absolute;
            left: 50%;
            top: 50%;
            width: 16px;
            height: 16px;
            border: 2px solid;
            border-radius: 50%;
            border-top-color: transparent;
            animation: spin 1s linear infinite;
            transform: translate(-50%, -50%);
        }

        .share-button.translating::after {
            border-color: #0077B5;
            border-top-color: transparent;
        }

        .generate-image-button.generating::after {
            border-color: #34a853;
            border-top-color: transparent;
        }

        /* Conteneur pour les boutons d'action */
        .action-buttons {
            display: flex;
            justify-content: space-between;
            padding: 0 16px;
            margin-bottom: 16px;
        }

        /* Styles pour les paramètres des boutons */
        .button-setting {
            margin-bottom: 20px;
            padding: 15px;
            background-color: #f9f9f9;
            border-radius: 5px;
            border: 1px solid #eee;
        }
        
        .button-setting label {
            margin-top: 10px;
        }
        
        .button-setting textarea {
            height: 60px;
        }
        
        .settings-content h3 {
            margin-top: 25px;
            color: #333;
            font-size: 18px;
            border-bottom: 1px solid #eee;
            padding-bottom: 8px;
        }
        
        body.dark-mode .button-setting {
            background-color: #2a2a2a;
            border-color: #444;
        }

        /* Styles pour les paramètres des boutons */
        .option-setting {
            margin: 15px 0;
            padding: 10px;
            background-color: #f9f9f9;
            border-radius: 5px;
            border: 1px solid #eee;
        }
        
        .option-setting label {
            display: flex;
            align-items: center;
            margin-top: 0;
            cursor: pointer;
        }
        
        .option-setting input[type="checkbox"] {
            margin-right: 10px;
        }
        
        body.dark-mode .option-setting {
            background-color: #2a2a2a;
            border-color: #444;
        }
        
        /* Style pour le titre principal */
        .app-title {
            text-align: center;
            color: #0077B5; /* Bleu LinkedIn */
            font-size: 24px;
            font-weight: 700;
            margin: 0;
            width: 100%;
            position: fixed;
            top: 10px;
            left: 0;
            z-index: 100;
            -webkit-app-region: drag;
            padding: 5px 0;
            background-color: #F2F0EC; /* Même couleur que le fond */
            backdrop-filter: none;
            -webkit-backdrop-filter: none;
            box-shadow: none;
        }
        
        body.dark-mode .app-title {
            color: #4d9eea; /* Bleu LinkedIn plus clair pour le mode sombre */
            background-color: transparent; /* Fond transparent en mode sombre */
            box-shadow: none;
        }

        /* Ajuster l'espacement pour éviter que le contenu ne passe sous le titre */
        .main-container {
            padding-top: 5px; /* Réduit de 60px à 45px */
        }

        .progress-bar-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background-color: #f0f0f0;
            overflow: hidden;
            display: none;
        }
        
        .progress-bar {
            width: 0%;
            height: 100%;
            background-color: #0077B5; /* Bleu LinkedIn */
            transition: width 0.5s ease;
        }

        body.dark-mode .progress-bar-container {
            background-color: #333;
        }

        .style-button.generate-img {
            background-color: transparent;
            color: #0077B5;
            border: 1px solid #0077B5;
        }

        .style-button.generate-img:hover {
            background-color: rgba(0, 119, 181, 0.1);
        }

        body.dark-mode .style-button.generate-img {
            color: #0a66c2;
            border-color: #0a66c2;
            background-color: transparent;
        }

        body.dark-mode .style-button.generate-img:hover {
            background-color: rgba(10, 102, 194, 0.1);
        }

        /* Style pour l'image générée */
        #image-preview {
            width: 100%;
            margin-top: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
        }

        #generated-image {
            max-width: 100%;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            margin-bottom: 15px;
        }

        body.dark-mode #generated-image {
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }

        /* Style pour l'icône de collapse */
        .collapse-icon {
            position: fixed;
            top: 20px;
            right: 120px; /* Positionné à gauche du bouton de thème */
            cursor: pointer;
            width: 40px;
            height: 40px;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: all 0.3s ease;
            padding: 0;
            background-color: white;
            border: none;
            border-radius: 50%;
            outline: none;
            z-index: 1000;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            -webkit-app-region: no-drag;
        }

        .collapse-icon:hover {
            opacity: 1;
        }

        .collapse-icon svg {
            width: 24px;
            height: 24px;
            color: #555;
            display: block;
            margin: auto;
        }

        body.dark-mode .collapse-icon svg {
            color: #0a66c2;
        }

        /* Style pour le texte tronqué */
        .text-collapsed {
            overflow: hidden;
            position: relative;
            max-height: 4.5em; /* Hauteur pour 3 lignes (1.5em par ligne) */
            line-height: 1.5em;
        }
        
        /* Effet de dégradé pour indiquer qu'il y a plus de contenu */
        .text-collapsed::after {
            content: "";
            position: absolute;
            bottom: 0;
            right: 0;
            width: 100%;
            height: 1.5em;
            background: linear-gradient(to bottom, rgba(255, 255, 255, 0), rgba(255, 255, 255, 1) 90%);
            pointer-events: none;
        }
        
        /* Ajuster le dégradé pour le mode sombre */
        body.dark-mode .text-collapsed::after {
            background: linear-gradient(to bottom, rgba(30, 30, 30, 0), rgba(30, 30, 30, 1) 90%);
        }

        .read-more-btn {
            color: #0077B5;
            font-weight: 500;
            cursor: pointer;
            display: inline-block;
            margin-top: 5px;
            padding-left: 15px; /* Ajout d'un padding à gauche pour aligner avec le texte */
            font-size: 14px;
        }
        
        .read-more-btn:hover {
            text-decoration: underline;
        }

        body.dark-mode .read-more-btn {
            color: #0a66c2;
        }

        /* Ajouter du vide en bas de la page */
        .main-column {
            padding-bottom: 60px;
        }

        /* Style pour le bouton de traduction */
        .style-button.translate {
            background-color: transparent;
            color: #0077B5;
            border: 1px solid #0077B5;
        }

        .style-button.translate:hover {
            background-color: rgba(0, 119, 181, 0.1);
        }

        body.dark-mode .style-button.translate {
            color: #0a66c2;
            border-color: #0a66c2;
            background-color: transparent;
        }

        body.dark-mode .style-button.translate:hover {
            background-color: rgba(10, 102, 194, 0.1);
        }

        #text-area:not(.placeholder-active) {
            color: #000; /* Noir pour le texte du post */
            font-weight: normal;
        }

        body.dark-mode #text-area:not(.placeholder-active) {
            color: #e0e0e0; /* Gris très clair pour le texte du post en mode sombre - meilleure lisibilité */
        }

        /* Style pour la dropdown de style DALL-E */
        #imageStyle {
            width: auto;
            min-width: 200px;
            max-width: 300px;
        }

        body.dark-mode .theme-icon, 
        body.dark-mode .settings-icon svg,
        body.dark-mode .collapse-icon svg {
            color: #eee;
        }

        .settings-icon svg {
            width: 24px;
            height: 24px;
            color: #555;
            display: block;
            margin: 0 auto;
        }

        .theme-toggle svg {
            width: 24px;
            height: 24px;
            color: #555;
            display: block;
            margin: 0 auto;
        }

        .collapse-icon svg {
            width: 24px;
            height: 24px;
            color: #555;
            display: block;
            margin: 0 auto;
        }

        body.dark-mode .settings-icon,
        body.dark-mode .theme-toggle,
        body.dark-mode .collapse-icon {
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
        }

        .custom-prompt-textarea {
            width: 100%;
            min-height: 80px;
            padding: 8px;
            margin-top: 5px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-family: inherit;
            resize: vertical;
        }

        body.dark-mode .custom-prompt-textarea {
            background-color: #2d2d2d;
            color: #ffffff;
            border-color: #444;
        }

        /* Style pour la scrollbar */
        ::-webkit-scrollbar {
            width: 10px;
        }

        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #555;
        }

        /* Style pour la scrollbar en mode sombre */
        body.dark-mode ::-webkit-scrollbar-track {
            background: #1a1a1a;
        }

        body.dark-mode ::-webkit-scrollbar-thumb {
            background: #444;
        }

        body.dark-mode ::-webkit-scrollbar-thumb:hover {
            background: #666;
        }
    </style>
</head>
<body>
    <!-- Suppression des contrôles de fenêtre personnalisés -->
    <div class="main-container">
        <h1 class="app-title">Writly</h1>
    <div class="linkedin-layout">
        <div class="left-column">
            <div class="profile-card"></div>
            <div class="dashboard-card"></div>
        </div>
        <div class="main-column">
            <div class="linkedin-post">
                <div class="progress-bar-container">
                    <div class="progress-bar"></div>
                </div>
                <div class="post-header">
                    <img src="avatar.jpg" alt="Avatar" class="avatar">
                    <div class="user-info">
                        <h3 class="user-name">John Doe</h3>
                        <p class="user-title" id="userJobTitle"></p>
                        <p class="post-time">7h • <span class="globe-icon">🌐</span></p>
                    </div>
                </div>
                <div id="text-area" contenteditable="true" data-placeholder="Écrivez votre thème ici..."></div>
<div id="image-preview" style="display: none;">
    <img id="generated-image" alt="Generated image">
    <button id="regenerate-image" style="display: none;" onclick="regenerateImage()">
        <svg class="regenerate-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.3"/>
        </svg>
    </button>
</div>
                <div class="style-buttons">
                    <button class="style-button" onclick="generateText('inspiring')">Inspirant</button>
                    <button class="style-button" onclick="generateText('promotional')">Promotionnel</button>
                    <button class="style-button" onclick="generateText('actionable')">Actionnable</button>
                    <button class="style-button" onclick="generateText('funny')">Drôle</button>
                    <button class="style-button erase" onclick="eraseText()">Effacer</button>
                        <button class="style-button copy" onclick="copyText()" style="display: none;">Copier</button>
                        <button class="style-button generate-img" onclick="generateImageFromPost()" style="display: none;">Générer une image</button>
                        <button class="style-button translate" onclick="translateToEnglish()" style="display: none;">Traduire en anglais</button>
                </div>
            </div>
            <div class="credit">
                Fait avec amour par <a href="https://dribbble.com/Adrien_Donot" target="_blank">Adrien DONOT</a>
            </div>
        </div>
        <div class="right-column">
            <div class="news-card"></div>
            <div class="ad-card"></div>
        </div>
    </div>

            <!-- Ajout de l'icône des réglages et des boutons de thème -->
            <button class="settings-icon" onclick="openSettings()">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M19.14,12.94c0.04-0.3,0.06-0.61,0.06-0.94c0-0.32-0.02-0.64-0.07-0.94l2.03-1.58c0.18-0.14,0.23-0.41,0.12-0.61 l-1.92-3.32c-0.12-0.22-0.37-0.29-0.59-0.22l-2.39,0.96c-0.5-0.38-1.03-0.7-1.62-0.94L14.4,2.81c-0.04-0.24-0.24-0.41-0.48-0.41 h-3.84c-0.24,0-0.43,0.17-0.47,0.41L9.25,5.35C8.66,5.59,8.12,5.92,7.63,6.29L5.24,5.33c-0.22-0.08-0.47,0-0.59,0.22L2.74,8.87 C2.62,9.08,2.66,9.34,2.86,9.48l2.03,1.58C4.84,11.36,4.8,11.69,4.8,12s0.02,0.64,0.07,0.94l-2.03,1.58 c-0.18,0.14-0.23,0.41-0.12,0.61l1.92,3.32c0.12,0.22,0.37,0.29,0.59,0.22l2.39-0.96c0.5,0.38,1.03,0.7,1.62,0.94l0.36,2.54 c0.05,0.24,0.24,0.41,0.48,0.41h3.84c0.24,0,0.44-0.17,0.47-0.41l0.36-2.54c0.59-0.24,1.13-0.56,1.62-0.94l2.39,0.96 c0.22,0.08,0.47,0,0.59-0.22l1.92-3.32c0.12-0.22,0.07-0.47-0.12-0.61L19.14,12.94z M12,15.6c-1.98,0-3.6-1.62-3.6-3.6 s1.62-3.6,3.6-3.6s3.6,1.62,3.6,3.6S13.98,15.6,12,15.6z"/>
                </svg>
            </button>

            <!-- Ajout du bouton de bascule de thème -->
            <button class="theme-toggle" onclick="toggleTheme()">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="theme-icon light-icon">
                    <path d="M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58c-.39-.39-1.03-.39-1.41 0-.39.39-.39 1.03 0 1.41l1.06 1.06c.39.39 1.03.39 1.41 0 .39-.39.39-1.03 0-1.41L5.99 4.58zm12.37 12.37c-.39-.39-1.03-.39-1.41 0-.39.39-.39 1.03 0 1.41l1.06 1.06c.39.39 1.03.39 1.41 0 .39-.39.39-1.03 0-1.41l-1.06-1.06zm1.06-10.96c.39-.39.39-1.03 0-1.41-.39-.39-1.03-.39-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41.39.39 1.03.39 1.41 0l1.06-1.06zM7.05 18.36c.39-.39.39-1.03 0-1.41-.39-.39-1.03-.39-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41.39.39 1.03.39 1.41 0l1.06-1.06z"/>
                </svg>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="theme-icon dark-icon" style="display: none;">
                    <path d="M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9 9-4.03 9-9c0-.46-.04-.92-.1-1.36-.98 1.37-2.58 2.26-4.4 2.26-2.98 0-5.4-2.42-5.4-5.4 0-1.81.89-3.42 2.26-4.4-.44-.06-.9-.1-1.36-.1z"/>
                </svg>
            </button>

            <!-- Ajout de l'icône de collapse -->
            <button class="collapse-icon" onclick="toggleTextCollapse()" style="display: none;">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="7 13 12 18 17 13"></polyline>
                    <polyline points="7 6 12 11 17 6"></polyline>
                </svg>
            </button>

    <div id="settingsModal" class="settings-modal">
        <div class="settings-content">
            <div class="settings-topbar">
                <h2>Paramètres</h2>
                <div class="settings-topbar-right">
                    <button onclick="saveSettings()" class="topbar-save">Sauvegarder</button>
                    <span class="close-button" onclick="closeSettings()">&times;</span>
                </div>
            </div>
            <label for="apiKey">Clé API OpenAI</label>
            <input type="text" id="apiKey" placeholder="Entrez votre clé API OpenAI">
            <label for="jobTitle">Votre métier</label>
            <input type="text" id="jobTitle" placeholder="Entrez votre métier">
            <label for="companyName">Nom de l'entreprise</label>
            <input type="text" id="companyName" placeholder="Entrez le nom de votre entreprise">
            <label for="userBackground">Contexte professionnel</label>
            <textarea id="userBackground" placeholder="Décrivez brièvement votre métier et vos passions"></textarea>
            <label for="language">Langue</label>
                <select id="language" onchange="updateButtonSettingsFields()">
                <option value="français">Français</option>
                <option value="anglais">Anglais</option>
            </select>
                
                <div class="option-setting">
                    <label for="autoTranslate">
                        <input type="checkbox" id="autoTranslate" checked>
                        Traduire automatiquement le contenu en français si nécessaire
                    </label>
                </div>
                
                <h3>Style d'image DALL-E</h3>
                <div class="option-setting">
                    <label for="imageStyle">Style d'image pour la génération</label>
                    <select id="imageStyle" class="image-style-select" onchange="toggleCustomPrompt()">
                        <option value="cartoon_3d">Cartoon 3D</option>
                        <option value="realistic">Réaliste</option>
                        <option value="digital_art">Art digital</option>
                        <option value="watercolor">Aquarelle</option>
                        <option value="oil_painting">Peinture à l'huile</option>
                        <option value="minimalist">Minimaliste</option>
                        <option value="studio_ghibli">Studio Ghibli</option>
                        <option value="pixar">Style Pixar expressif</option>
                        <option value="coloring_book">Page de livre de coloriage</option>
                        <option value="isometric">Scène isométrique 3D</option>
                        <option value="comic_strip">Bande dessinée</option>
                        <option value="graffiti">Art graffiti</option>
                        <option value="custom">Style personnalisé...</option>
                    </select>
                    <div id="customPromptContainer" style="display: none; margin-top: 10px;">
                        <label for="customPrompt">Prompt personnalisé DALL-E</label>
                        <textarea id="customPrompt" class="custom-prompt-textarea" placeholder="Décrivez le style d'image souhaité..."></textarea>
                    </div>
                </div>

                <script>
                    function toggleCustomPrompt() {
                        const imageStyle = document.getElementById('imageStyle');
                        const customPromptContainer = document.getElementById('customPromptContainer');
                        customPromptContainer.style.display = imageStyle.value === 'custom' ? 'block' : 'none';
                        
                        // Sauvegarder le style sélectionné
                        localStorage.setItem('imageStyle', imageStyle.value);
                    }

                    // Charger le style sauvegardé au chargement de la page
                    document.addEventListener('DOMContentLoaded', function() {
                        const savedStyle = localStorage.getItem('imageStyle');
                        if (savedStyle) {
                            const imageStyle = document.getElementById('imageStyle');
                            imageStyle.value = savedStyle;
                            toggleCustomPrompt(); // Pour afficher le champ personnalisé si nécessaire
                        }
                    });
                </script>
                
                <h3>Personnalisation des boutons</h3>
                <div id="button-settings">
                    <div class="button-setting">
                        <label for="button1_name">Nom du bouton 1</label>
                        <input type="text" id="button1_name" placeholder="Ex: Inspirant">
                        <label for="button1_prompt">Prompt du bouton 1 (utilisez {theme} pour insérer le thème)</label>
                        <textarea id="button1_prompt" placeholder="Ex: Créez un post LinkedIn inspirant sur le thème '{theme}'..."></textarea>
                    </div>
                    <div class="button-setting">
                        <label for="button2_name">Nom du bouton 2</label>
                        <input type="text" id="button2_name" placeholder="Ex: Promotionnel">
                        <label for="button2_prompt">Prompt du bouton 2 (utilisez {theme} pour insérer le thème)</label>
                        <textarea id="button2_prompt" placeholder="Ex: Rédigez un post LinkedIn promotionnel sur le thème '{theme}'..."></textarea>
                    </div>
                    <div class="button-setting">
                        <label for="button3_name">Nom du bouton 3</label>
                        <input type="text" id="button3_name" placeholder="Ex: Actionnable">
                        <label for="button3_prompt">Prompt du bouton 3 (utilisez {theme} pour insérer le thème)</label>
                        <textarea id="button3_prompt" placeholder="Ex: Créez un post LinkedIn actionnable sur le thème '{theme}'..."></textarea>
                    </div>
                    <div class="button-setting">
                        <label for="button4_name">Nom du bouton 4</label>
                        <input type="text" id="button4_name" placeholder="Ex: Drôle">
                        <label for="button4_prompt">Prompt du bouton 4 (utilisez {theme} pour insérer le thème)</label>
                        <textarea id="button4_prompt" placeholder="Ex: Rédigez un post LinkedIn humoristique sur le thème '{theme}'..."></textarea>
                    </div>
                </div>
                
        </div>
    </div>

    <!-- Ajout d'une modal pour les instructions -->
    <div id="instructionsModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Instructions pour partager sur LinkedIn</h2>
            <ol>
                <li>Cliquez sur le bouton ci-dessous pour copier le script.</li>
                <li>Ouvrez LinkedIn et cliquez sur "Commencer un post".</li>
                <li>Appuyez sur F12 pour ouvrir la console de développement.</li>
                <li>Collez le script dans la console et appuyez sur Entrée.</li>
                <li>Votre post devrait maintenant apparaître dans l'éditeur LinkedIn !</li>
            </ol>
            <textarea id="scriptArea" readonly></textarea>
            <button id="copyScript">Copier le script</button>
        </div>
    </div>

    <!-- Ajoutez ceci dans votre modal de paramètres si ce n'est déjà fait -->
    <div id="settings-modal" class="modal">
        <div class="modal-content">
            <h2>Paramètres</h2>
            <label for="full-name">Nom et Prnom :</label>
            <input type="text" id="full-name" placeholder="John Doe">
            <label for="openai-key">Clé API OpenAI :</label>
            <input type="password" id="openai-key" placeholder="Votre clé API OpenAI">
            <button id="save-settings">Sauvegarder</button>
        </div>
    </div>

    <!-- Ajoutez ceci pour la zone de contenu principal -->
    <div id="main-content">
        <!-- Le contenu principal de votre page ira ici -->
        </div>
    </div>

    <script>
        // Ajoutez cette liste de noms au début de votre fichier JavaScript
        const names = [
          "John Smith", "Emma Johnson", "Michael Brown", "Olivia Davis", "William Wilson", "Sophia Miller", "James Garcia", "Ava Rodriguez", "Robert Martinez", "Emily Lee",
          "David White", "Isabella Harris", "Joseph King", "Mia Wright", "Daniel Lewis", "Charlotte Hall", "Matthew Allen", "Amelia Young", "Andrew King", "Harper Scott",
          "Christopher Thompson", "Evelyn Martin", "Benjamin Anderson", "Abigail Thomas", "Nicholas Jackson", "Elizabeth White", "Ryan Harris", "Sofia Martinez", "Tyler Davis", "Avery Robinson",
          "Ethan Clark", "Madison Taylor", "Alexander Adams", "Grace Turner", "Nathan Campbell", "Chloe Parker", "Samuel Phillips", "Zoe Evans", "Jonathan Stewart", "Lily Cooper",
          "Christian Murphy", "Layla Bennett", "Noah Richardson", "Hannah Cook", "Dylan Rogers", "Aria Reed", "Liam Coleman", "Aubrey Bailey", "Owen Howard", "Ellie Cox",
          "Luke Jenkins", "Zoey Diaz", "Gabriel Perez", "Nora Foster", "Isaac Ross", "Audrey Gray", "Julian Long", "Claire Kelly", "Henry Ward", "Skylar Peterson",
          "Wyatt Brooks", "Bella Sanders", "Carter Price", "Lucy Barnes", "Jayden Henderson", "Savannah Perry", "Owen Russell", "Stella Hughes", "Eli Butler", "Maya Price",
          "Isaiah Simmons", "Paisley Powell", "Charles Patterson", "Everly Long", "Jaxon Wood", "Ivy Morgan", "Christopher Reed", "Willow Foster", "Lincoln Hughes", "Addison Butler",
          "Hunter Bryant", "Brooklyn Ross", "Caleb Coleman", "Natalie Gray", "Ryan Jenkins", "Autumn Ward", "Asher Peterson", "Quinn Brooks", "Nathan West", "Piper Richardson",
          "Aaron Foster", "Sadie Bennett", "Landon Russell", "Violet Cox", "Carson Gray", "Ruby Price", "Adrian Price", "Kennedy Morgan", "Cameron Hughes", "Cora Patterson",
          "Austin Reed", "Hazel Stewart", "Colton Bryant", "Luna Coleman", "Dominic Butler", "Emilia Foster", "Ian Peterson", "Mila Jenkins", "Eli Ross", "Eva Bryant",
          "Jace Morgan", "Isla Hughes", "Maxwell Patterson", "Eleanor Butler", "Silas Foster", "Emery Peterson", "Declan Bryant", "Naomi Coleman", "Sawyer Jenkins", "Eliana Ross",
          "Weston Morgan", "Lila Patterson", "Roman Butler", "Athena Foster", "Finn Peterson", "Delilah Bryant", "Matteo Coleman", "Gabriella Jenkins", "Emmett Ross", "Diana Morgan",
          "Brayden Patterson", "Leia Butler", "August Foster", "Nova Peterson", "Jasper Bryant", "Lydia Coleman", "Everett Jenkins", "Jade Ross", "Greyson Morgan", "Keira Patterson",
          "Axel Butler", "Kenzie Foster", "Roman Peterson", "Iris Bryant", "Kaden Coleman", "Daisy Jenkins", "Zion Ross", "Juliana Morgan", "Elliot Patterson", "Brielle Butler"
        ];

        // Fonction pour obtenir un nom aléatoire
        function getRandomName() {
          return names[Math.floor(Math.random() * names.length)];
        }

        // Modifiez la fonction updateUserInfo pour utiliser un nom aléatoire
        function updateUserInfo() {
            const jobTitle = localStorage.getItem('userJobTitle') || '';
            const companyName = localStorage.getItem('userCompanyName') || '';
            const userNameElement = document.querySelector('.user-name');
            const userTitleElement = document.getElementById('userJobTitle');
            const avatarElement = document.querySelector('.avatar');
            
            // Mettre à jour le nom avec un nom aléatoire
            userNameElement.textContent = getRandomName();
            
            if (jobTitle) {
                let fullTitle = jobTitle;
                if (companyName) {
                    fullTitle += ` at ${companyName}`;
                }
                userTitleElement.textContent = fullTitle;
            } else {
                userTitleElement.textContent = '';
            }

            // Mettre à jour l'avatar avec une image aléatoire
            avatarElement.src = getRandomAvatar();
        }

        // Assurez-vous d'appeler updateUserInfo() au chargement de la page et après chaque génération de post
        document.addEventListener('DOMContentLoaded', updateUserInfo);

        // Ajout des tableaux de hooks pour chaque style
        const hooks = {
            inspiring: [
                "I want to tell you a story how...",
                "Imagine you're...",
                "I want to be honest for a second",
                "I have to talk about this",
                "Storytime...",
                "I committed to [doing thing] [time] ago. Here are my results:",
                "I couldn't believe it",
                "There had to be another way",
                "I put everything I had into it",
                "It felt like a punch to the gut...",
                "I lost everything, but...",
                "My hands were shaking when...",
                "I wanted to give up, until...",
                "Here's what changed everything for me...",
                "The moment I realized...",
                "What I'm about to share...",
                "This transformed my approach to...",
                "The truth about success is..."
            ],
            promotional: [
                "Need ideas for...",
                "Did you know that...",
                "Wondering how to...",
                "Here's how you can [do thing] for free:",
                "The easiest way to...",
                "I was so impressed by X I thought I'd share it",
                "Here are the secrets to...",
                "Quick hack to...",
                "This changed everything in my...",
                "The one tool that transformed my...",
                "Want to know how I...",
                "I discovered this game-changing...",
                "This approach revolutionized my...",
                "The strategy that doubled my...",
                "Finally, a solution for...",
                "Stop struggling with... Here's why:"
            ],
            actionable: [
                "X Tips to...",
                "Here's how to [do thing] in simple steps:",
                "X ways to...",
                "Quick tip to...",
                "Here are X dead-simple ways to...",
                "These traits are so underrated, yet they can...",
                "[advice] — here's how:",
                "X things that destroy [something your audience cares about]:",
                "The framework I use to...",
                "Step-by-step guide to...",
                "Master these X skills to...",
                "Transform your results with these X...",
                "The exact method I use for...",
                "X proven strategies to...",
                "The ultimate checklist for...",
                "Here's what actually works for..."
            ],
            funny: [
                "I tried [doing thing]. There were weird results:",
                "You would not believe this",
                "This is one of the most fierce enemies of...",
                "Doing _____ is like _____. Here's why",
                "It felt like a punch to the gut...",
                "They laughed at me",
                "It was brutal",
                "Unpopular opinion:",
                "The hilarious truth about...",
                "What nobody tells you about...",
                "The biggest myth in...",
                "Plot twist:",
                "The real reason why...",
                "When everything went wrong...",
                "The awkward moment when...",
                "This is what happens when..."
            ]
        };

        // Modification de la fonction generateText pour utiliser les hooks
        async function generateText(style) {
            try {
                const apiKey = localStorage.getItem('openaiApiKey');
                if (!apiKey) {
                    alert('Veuillez d\'abord configurer votre clé API OpenAI dans les paramètres.');
                    return;
                }

                // Sélection aléatoire d'un hook pour le style choisi
                const styleHooks = hooks[style];
                const randomHook = styleHooks[Math.floor(Math.random() * styleHooks.length)];
                
                const textArea = document.getElementById('text-area');
                const theme = textArea.textContent.trim();
                
                if (!theme) {
                    alert('Veuillez d\'abord entrer un thème.');
                    return;
                }

                // Modification du prompt pour inclure le hook
                const prompt = {
                    role: 'user',
                    content: `Utilise ce hook: "${randomHook}" pour créer un post LinkedIn ${style} sur le thème: ${theme}`
                };

                const progressBarContainer = document.querySelector('.progress-bar-container');
                const progressBar = document.querySelector('.progress-bar');
                
                // Afficher la barre de progression
                progressBarContainer.style.display = 'block';
                progressBar.style.width = '0%';

                // Simuler une progression pour la génération de texte
                let progress = 0;
                const progressInterval = setInterval(() => {
                    progress += 2.5;
                    if (progress > 45) {
                        clearInterval(progressInterval);
                    }
                    progressBar.style.width = `${progress}%`;
                }, 100);

                const jobTitle = localStorage.getItem('userJobTitle') || 'professionnel';
                const userBackground = localStorage.getItem('userBackground') || 'Pas de contexte fourni';
                const language = localStorage.getItem('userLanguage') || 'français';
                const autoTranslate = localStorage.getItem('autoTranslate') !== 'false'; // Par défaut à true si non défini
                
                if (!apiKey) {
                    alert('Veuillez définir votre clé API OpenAI dans les paramètres.');
                    return;
                }

                // Récupérer le prompt personnalisé pour ce style
                let stylePrompt = getCustomPrompt(style, theme);

                const response = await fetch('https://api.openai.com/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${apiKey}`
                    },
                    body: JSON.stringify({
                        model: "gpt-4.5-preview-2025-02-27",
                        messages: [
                        {
    role: "system",
    content: language === 'français' 
        ? "Écris comme si tu parlais à un ami. Simple, naturel. Pas d'emoji. Pas de mise en forme. Pas de hashtags. Alterne phrases courtes et longues, mais reste fluide. Beaucoup de sauts de ligne pour la lisibilité sur mobile. Évite les accroches génériques qui sonnent fake. Pas de structure question-réponse comme 'Le secret ? C'est plus simple que tu ne le penses'. Si tu poses une question à la fin, fais-la naturelle et pertinente, comme 'T'en penses quoi ?'. Écris comme un humain, pas comme une IA. Utilise des mots simples, comme si tu avais 10 ans."
        : "Write like you're talking to a friend. Simple, natural. No emojis. No formatting. No hashtags. Alternate short and long sentences, but keep it flowing. Lots of line breaks for mobile readability. Avoid generic hooks that sound fake. No question-answer structures like 'The tweak? It's simpler than you think.' If you ask a final question, make it natural and relevant, like 'What's your take?'. Write like a human, not AI. Use simple words, like a 10-year-old."
},
                            {
                                role: "user",
                                content: stylePrompt
                            }
                        ]
                    })
                });

                const data = await response.json();
                if (!response.ok) {
                    throw new Error(data.error?.message || 'Erreur lors de la génération du texte');
                }
                
                if (data.choices && data.choices.length > 0) {
                    let generatedText = data.choices[0].message.content;
                    generatedText = generatedText.replace(/^Titre\s*:\s*/i, '');
                    generatedText = generatedText.replace(/\*\*/g, '');
                    generatedText = generatedText.replace(/#\w+/g, '');
                    // Nettoyer le texte généré pour supprimer "éativité" ou tout autre texte indésirable à la fin
                    generatedText = generatedText.replace(/éativité\s*$/i, '');
                    
                    // Vérifier si le texte doit être traduit
                    if (language === 'français' && autoTranslate && isTextInEnglish(generatedText)) {
                        // Mettre à jour la barre de progression pour indiquer la traduction
                        progressBar.style.width = '70%';
                        
                        // Traduire le texte en français
                        generatedText = await translateText(generatedText, 'fr', apiKey);
                    } else if (language === 'anglais' && autoTranslate && isTextInFrench(generatedText)) {
                        // Mettre à jour la barre de progression pour indiquer la traduction
                        progressBar.style.width = '70%';
                        
                        // Traduire le texte en anglais
                        generatedText = await translateText(generatedText, 'en', apiKey);
                    }
                    
                    // Compléter la barre de progression
                    clearInterval(progressInterval);
                    progressBar.style.width = '100%';

                    // Attendre un court instant avant d'injecter le texte
                    await new Promise(resolve => setTimeout(resolve, 500));

                    // S'assurer que le text-area n'a pas la classe placeholder-active
                    textArea.classList.remove('placeholder-active');
                    textArea.setAttribute('data-placeholder-active', 'false');
                    
                    // Définir la couleur du texte en fonction du mode (clair ou sombre)
                    if (document.body.classList.contains('dark-mode')) {
                        textArea.style.color = '#e0e0e0'; // Couleur claire pour le mode sombre
                    } else {
                        textArea.style.color = '#000000'; // Couleur noire pour le mode clair
                    }
                    
                    textArea.classList.add('black-text');

                    await textScramble.setText(generatedText);
                    updateUserInfo();
                    
                    // Cacher les boutons de style sauf "Effacer" et afficher "Copier"
                    hideStyleButtons();
                }
            } catch (error) {
                console.error('Erreur lors de la génération:', error);
                alert(`Une erreur s'est produite: ${error.message}`);
            } finally {
                setTimeout(() => {
                    progressBarContainer.style.display = 'none';
                    progressBar.style.width = '0%';
                }, 500);
            }
        }

        // Fonction pour détecter si le texte est en anglais
        function isTextInEnglish(text) {
            // Liste de mots anglais courants qui n'existent pas en français
            const englishWords = ['the', 'and', 'is', 'in', 'to', 'it', 'that', 'with', 'for', 'as', 'on', 'at', 'by', 'from', 'was', 'were', 'are'];
            
            // Convertir le texte en minuscules et le diviser en mots
            const words = text.toLowerCase().split(/\s+/);
            
            // Compter combien de mots anglais courants sont présents
            let englishWordCount = 0;
            for (const word of words) {
                if (englishWords.includes(word)) {
                    englishWordCount++;
                }
            }
            
            // Si plus de 3 mots anglais courants sont présents, considérer le texte comme étant en anglais
            return englishWordCount > 3;
        }

        // Fonction pour détecter si le texte est en français
        function isTextInFrench(text) {
            // Liste de mots français courants qui n'existent pas en anglais
            const frenchWords = ['le', 'la', 'les', 'un', 'une', 'des', 'est', 'sont', 'et', 'ou', 'mais', 'donc', 'car', 'pour', 'dans', 'avec', 'sur', 'sous', 'par', 'ce', 'cette', 'ces', 'mon', 'ton', 'son', 'notre', 'votre', 'leur'];
            
            // Convertir le texte en minuscules et le diviser en mots
            const words = text.toLowerCase().split(/\s+/);
            
            // Compter combien de mots français courants sont présents
            let frenchWordCount = 0;
            for (const word of words) {
                if (frenchWords.includes(word)) {
                    frenchWordCount++;
                }
            }
            
            // Si plus de 3 mots français courants sont présents, considérer le texte comme étant en français
            return frenchWordCount > 3;
        }

        // Fonction pour traduire le texte
        async function translateText(text, targetLanguage, apiKey) {
            try {
                const response = await fetch('https://api.openai.com/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${apiKey}`
                    },
                    body: JSON.stringify({
                        model: "gpt-3.5-turbo",
                        messages: [
                            {
                                role: "system",
                                content: "Vous êtes un traducteur professionnel. Traduisez le texte fourni en conservant le style et le ton d'origine."
                            },
                            {
                                role: "user",
                                content: `Traduisez ce texte en français, en conservant le style et le format d'origine:\n\n${text}`
                            }
                        ]
                    })
                });

                const data = await response.json();
                if (!response.ok) {
                    throw new Error(data.error?.message || 'Erreur lors de la traduction');
                }

                if (data.choices && data.choices.length > 0) {
                    return data.choices[0].message.content;
                }
                
                return text; // Retourner le texte original en cas d'échec
            } catch (error) {
                console.error('Erreur lors de la traduction:', error);
                return text; // Retourner le texte original en cas d'erreur
            }
        }

        // Fonction pour obtenir le prompt personnalisé pour un style donné
        function getCustomPrompt(style, theme) {
            const language = localStorage.getItem('userLanguage') || 'français';
            const buttonIndex = getButtonIndexForStyle(style);
            const customPrompt = localStorage.getItem(`button${buttonIndex}_prompt_${language}`);
            
            if (customPrompt) {
                return customPrompt.replace('{theme}', theme);
            }
            
            // Prompts par défaut si aucun prompt personnalisé n'est défini
            if (language === 'français') {
                switch(style) {
                    case 'inspiring':
                        return `Créez un post LinkedIn inspirant sur le thème "${theme}". Le post ne doit pas avoir de liste d'action ou de point, il doit être impactant. Le post doit motiver et encourager les lecteurs.`;
                    case 'promotional':
                        return `Rédigez un post LinkedIn promotionnel sur le thème "${theme}". Mettez en avant les avantages et aspects positifs du sujet.`;
                    case 'actionable':
                        return `Créez un post LinkedIn actionnable sur le thème "${theme}". Proposez des actions concrètes avec des objectifs clairs.`;
                    case 'funny':
                        return `Rédigez un post LinkedIn humoristique et court sur le thème "${theme}". Le post doit être léger, amusant et impactant.`;
                    default:
                        return `Créez un post LinkedIn engageant sur le thème "${theme}".`;
                }
            } else {
                switch(style) {
                    case 'inspiring':
                        return `Create an inspiring LinkedIn post about "${theme}". The post should not have a list of actions or points, it should be impactful. The post should motivate and encourage readers.`;
                    case 'promotional':
                        return `Write a promotional LinkedIn post about "${theme}". Highlight the benefits and positive aspects of the subject.`;
                    case 'actionable':
                        return `Create an actionable LinkedIn post about "${theme}". Propose concrete actions with clear objectives.`;
                    case 'funny':
                        return `Write a humorous and short LinkedIn post about "${theme}". The post should be light, fun and impactful.`;
                    default:
                        return `Create an engaging LinkedIn post about "${theme}".`;
                }
            }
        }
        
        // Fonction pour obtenir l'index du bouton correspondant au style
        function getButtonIndexForStyle(style) {
            switch(style) {
                case 'inspiring': return 1;
                case 'promotional': return 2;
                case 'actionable': return 3;
                case 'funny': return 4;
                default: return 1;
            }
        }
        
        // Fonction pour obtenir le style correspondant à l'index du bouton
        function getStyleForButtonIndex(index) {
            switch(index) {
                case 1: return 'inspiring';
                case 2: return 'promotional';
                case 3: return 'actionable';
                case 4: return 'funny';
                default: return 'inspiring';
            }
        }

        function eraseText() {
            const textArea = document.getElementById('text-area');
            
            textArea.innerHTML = '';
            updatePlaceholder();

            // Effacer l'image
            const imagePreview = document.getElementById('image-preview');
            imagePreview.innerHTML = '';
            imagePreview.style.display = 'none';
            
            // Réafficher tous les boutons de style
            showStyleButtons();
        }
        
        // Fonction pour copier le texte dans le presse-papier
        function copyText() {
            const textArea = document.getElementById('text-area');
            const text = textArea.textContent;
            
            navigator.clipboard.writeText(text)
                .then(() => {
                    // Animation de confirmation ou notification
                    const copyButton = document.querySelector('.style-button.copy');
                    const originalText = copyButton.textContent;
                    copyButton.textContent = 'Copié !';
                    setTimeout(() => {
                        copyButton.textContent = originalText;
                    }, 2000);
                })
                .catch(err => {
                    console.error('Erreur lors de la copie :', err);
                    alert('Erreur lors de la copie du texte');
                });
        }
        
        // Fonction pour cacher les boutons de style sauf "Effacer" et afficher "Copier"
        function hideStyleButtons() {
            const styleButtons = document.querySelectorAll('.style-button:not(.erase):not(.copy):not(.generate-img):not(.translate)');
            styleButtons.forEach(button => {
                button.style.display = 'none';
            });
            
            // Afficher le bouton Copier et Générer une image
            const copyButton = document.querySelector('.style-button.copy');
            if (copyButton) {
                copyButton.style.display = 'inline-block';
            }
            
            const generateImgButton = document.querySelector('.style-button.generate-img');
            if (generateImgButton) {
                generateImgButton.style.display = 'inline-block';
            }
            
            const translateButton = document.querySelector('.style-button.translate');
            if (translateButton) {
                translateButton.style.display = 'inline-block';
            }
            
            // Afficher l'icône de collapse
            const collapseIcon = document.querySelector('.collapse-icon');
            if (collapseIcon) {
                collapseIcon.style.display = 'flex';
            }
        }
        
        // Fonction pour réafficher tous les boutons de style et cacher "Copier"
        function showStyleButtons() {
            const styleButtons = document.querySelectorAll('.style-button:not(.erase):not(.copy):not(.generate-img):not(.translate)');
            styleButtons.forEach(button => {
                button.style.display = 'inline-block';
            });
            
            // Cacher le bouton Copier et Générer une image
            const copyButton = document.querySelector('.style-button.copy');
            if (copyButton) {
                copyButton.style.display = 'none';
            }
            
            const generateImgButton = document.querySelector('.style-button.generate-img');
            if (generateImgButton) {
                generateImgButton.style.display = 'none';
            }
            
            const translateButton = document.querySelector('.style-button.translate');
            if (translateButton) {
                translateButton.style.display = 'none';
            }
            
            // Cacher l'icône de collapse
            const collapseIcon = document.querySelector('.collapse-icon');
            if (collapseIcon) {
                collapseIcon.style.display = 'none';
            }
            
            // S'assurer que le texte n'est pas tronqué
            const textArea = document.getElementById('text-area');
            if (textArea) {
                textArea.classList.remove('text-collapsed');
                const readMoreBtn = document.querySelector('.read-more-btn');
                if (readMoreBtn) {
                    readMoreBtn.remove();
                }
            }
        }

        class TextScramble {
            constructor(el) {
                this.el = el;
                this.chars = '!<>-_\\/[]{}—=+*^?#________';
                this.update = this.update.bind(this);
            }
            setText(newText) {
                const oldText = this.el.innerText;
                const length = Math.max(oldText.length, newText.length);
                const promise = new Promise((resolve) => this.resolve = resolve);
                this.queue = [];
                for (let i = 0, n = length; i < n; i++) {
                    const from = oldText[i] || '';
                    const to = newText[i] || '';
                    const start = Math.floor(Math.random() * 160);
                    const end = start + Math.floor(Math.random() * 160);
                    this.queue.push({ from, to, start, end });
                }
                cancelAnimationFrame(this.frameRequest);
                this.frame = 0;
                this.update();
                return promise;
            }
            update() {
                let output = '';
                let complete = 0;
                for (let i = 0, n = this.queue.length; i < n; i++) {
                    let { from, to, start, end, char } = this.queue[i];
                    if (this.frame >= end) {
                        complete++;
                        output += to;
                    } else if (this.frame >= start) {
                        if (!char || Math.random() < 0.07) {
                            char = this.randomChar();
                            this.queue[i].char = char;
                        }
                        output += `<span class="dud">${char}</span>`;
                    } else {
                        output += from;
                    }
                }
                this.el.innerHTML = output;
                if (complete === this.queue.length) {
                    this.resolve();
                } else {
                    this.frameRequest = requestAnimationFrame(this.update);
                    this.frame++;
                }
            }
            randomChar() {
                return this.chars[Math.floor(Math.random() * this.chars.length)];
            }
        }

        const textScramble = new TextScramble(document.getElementById('text-area'));

        function openSettings() {
            const settingsModal = document.getElementById('settingsModal');
            if (settingsModal) {
                settingsModal.style.display = 'block';
            } else {
                console.error('Modal des paramètres non trouvée');
            }
        }

        function closeSettings() {
            document.getElementById('settingsModal').style.display = 'none';
        }

        // Fermer la modal si l'utilisateur clique en dehors
        window.onclick = function(event) {
            const modal = document.getElementById('instructionsModal');
            if (event.target == modal) {
                modal.style.display = 'none';
            }
        }

        function saveSettings() {
            const apiKey = document.getElementById('apiKey').value;
            const jobTitle = document.getElementById('jobTitle').value;
            const userBackground = document.getElementById('userBackground').value;
            const language = document.getElementById('language').value;
            const companyName = document.getElementById('companyName').value;
            const autoTranslate = document.getElementById('autoTranslate').checked;
            const imageStyle = document.getElementById('imageStyle').value;

            localStorage.setItem('openaiApiKey', apiKey);
            localStorage.setItem('userJobTitle', jobTitle);
            localStorage.setItem('userBackground', userBackground);
            localStorage.setItem('userLanguage', language);
            localStorage.setItem('userCompanyName', companyName);
            localStorage.setItem('autoTranslate', autoTranslate);
            localStorage.setItem('imageStyle', imageStyle);
            
            // Sauvegarder les paramètres des boutons
            for (let i = 1; i <= 4; i++) {
                const buttonName = document.getElementById(`button${i}_name`).value;
                const buttonPrompt = document.getElementById(`button${i}_prompt`).value;
                
                if (buttonName) {
                    localStorage.setItem(`button${i}_name_${language}`, buttonName);
                }
                
                if (buttonPrompt) {
                    localStorage.setItem(`button${i}_prompt_${language}`, buttonPrompt);
                }
            }

            updateUserInfo();
            updateButtonLabels();
            closeSettings();
        }

        function loadSettings() {
            const apiKey = localStorage.getItem('openaiApiKey') || '';
            const jobTitle = localStorage.getItem('userJobTitle') || '';
            const userBackground = localStorage.getItem('userBackground') || '';
            const language = localStorage.getItem('userLanguage') || 'français';
            const companyName = localStorage.getItem('userCompanyName') || '';
            const autoTranslate = localStorage.getItem('autoTranslate') === 'true';
            const imageStyle = localStorage.getItem('imageStyle') || 'cartoon_3d';

            document.getElementById('apiKey').value = apiKey;
            document.getElementById('jobTitle').value = jobTitle;
            document.getElementById('userBackground').value = userBackground;
            document.getElementById('language').value = language;
            document.getElementById('companyName').value = companyName;
            document.getElementById('autoTranslate').checked = autoTranslate;
            
            if (document.getElementById('imageStyle')) {
                document.getElementById('imageStyle').value = imageStyle;
            }

            updateUserInfo();
            updateButtonSettingsFields();
            updateButtonLabels();
        }
        
        // Fonction pour mettre à jour les champs de paramètres des boutons en fonction de la langue
        function updateButtonSettingsFields() {
            const language = document.getElementById('language').value;
            
            for (let i = 1; i <= 4; i++) {
                const buttonNameField = document.getElementById(`button${i}_name`);
                const buttonPromptField = document.getElementById(`button${i}_prompt`);
                
                // Récupérer les valeurs sauvegardées pour cette langue
                const savedName = localStorage.getItem(`button${i}_name_${language}`);
                const savedPrompt = localStorage.getItem(`button${i}_prompt_${language}`);
                
                // Définir les valeurs par défaut en fonction de la langue et de l'index du bouton
                let defaultName, defaultPrompt;
                
                if (language === 'français') {
                    switch(i) {
                        case 1:
                            defaultName = 'Inspirant';
                            defaultPrompt = 'Partagez une expérience sur {theme} de façon simple et directe. Utilisez des phrases courtes. Pas de formatage. Pas d\'emoji. Espacez bien les lignes pour la lecture mobile. Écrivez comme si vous parliez à un ami.';
                            break;
                        case 2:
                            defaultName = 'Promotionnel';
                            defaultPrompt = 'Racontez simplement ce qui est intéressant avec {theme}. Allez droit au but. Utilisez des mots simples. Faites des retours à la ligne fréquents. Restez naturel comme dans une conversation.';
                            break;
                        case 3:
                            defaultName = 'Actionnable';
                            defaultPrompt = 'Expliquez {theme} comme si vous parliez à un débutant. Phrases simples et courtes. Beaucoup d\'espaces entre les lignes. Pas de formatage ni d\'emoji. Donnez des conseils pratiques sans complexité.';
                            break;
                        case 4:
                            defaultName = 'Drôle';
                            defaultPrompt = 'Une histoire légère sur {theme}. Gardez ça simple et naturel. Comme si vous la racontiez à un ami. Phrases courtes. Espacez bien le texte. Sans emoji ni formatage.';
                            break;
                    }
                } else {
                    switch(i) {
                        case 1:
                            defaultName = 'Inspiring';
                            defaultPrompt = 'Share an experience about {theme} in a simple, direct way. Use short sentences. No formatting. No emojis. Space out lines for mobile reading. Write like you\'re talking to a friend.';
                            break;
                        case 2:
                            defaultName = 'Promotional';
                            defaultPrompt = 'Tell us what\'s interesting about {theme}. Get straight to the point. Use simple words. Add frequent line breaks. Keep it natural like a conversation.';
                            break;
                        case 3:
                            defaultName = 'Actionable';
                            defaultPrompt = 'Explain {theme} like you\'re talking to a beginner. Simple, short sentences. Lots of space between lines. No formatting or emojis. Give practical advice without complexity.';
                            break;
                        case 4:
                            defaultName = 'Funny';
                            defaultPrompt = 'A light story about {theme}. Keep it simple and natural. Like you\'re telling it to a friend. Short sentences. Well-spaced text. No emojis or formatting.';
                            break;
                    }
                }
                
                // Mettre à jour les champs avec les valeurs sauvegardées ou les valeurs par défaut
                buttonNameField.value = savedName || defaultName;
                buttonPromptField.value = savedPrompt || defaultPrompt;
            }
        }
        
        // Fonction pour mettre à jour les libellés des boutons de style
        function updateButtonLabels() {
            const language = localStorage.getItem('userLanguage') || 'français';
            const styleButtons = document.querySelectorAll('.style-button:not(.erase):not(.copy):not(.generate-img):not(.translate)');
            
            styleButtons.forEach((button, index) => {
                const buttonIndex = index + 1;
                const style = getStyleForButtonIndex(buttonIndex);
                const customName = localStorage.getItem(`button${buttonIndex}_name_${language}`);
                
                if (customName) {
                    button.textContent = customName;
                } else {
                    // Utiliser les noms par défaut si aucun nom personnalisé n'est défini
                    if (language === 'français') {
                        switch(buttonIndex) {
                            case 1: button.textContent = 'Inspirant'; break;
                            case 2: button.textContent = 'Promotionnel'; break;
                            case 3: button.textContent = 'Actionnable'; break;
                            case 4: button.textContent = 'Drôle'; break;
            }
        } else {
                        switch(buttonIndex) {
                            case 1: button.textContent = 'Inspiring'; break;
                            case 2: button.textContent = 'Promotional'; break;
                            case 3: button.textContent = 'Actionable'; break;
                            case 4: button.textContent = 'Funny'; break;
                        }
                    }
                }
                
                // Mettre à jour l'attribut onclick pour utiliser le style correct
                button.setAttribute('onclick', `generateText('${style}')`);
            });
            
            // Mettre à jour le bouton Effacer
            const eraseButton = document.querySelector('.style-button.erase');
            if (eraseButton) {
                eraseButton.textContent = language === 'français' ? 'Effacer' : 'Erase';
            }
            
            // Mettre à jour le bouton Copier
            const copyButton = document.querySelector('.style-button.copy');
            if (copyButton) {
                copyButton.textContent = language === 'français' ? 'Copier' : 'Copy';
            }
        }

        // Fonction pour obtenir un avatar aléatoire
        function getRandomAvatar() {
            const randomNumber = Math.floor(Math.random() * 119) + 1;
            return `avatars/${randomNumber}.jpg`;
        }

        // Ajouter ce script pour gérer le placeholder
        const textArea = document.getElementById('text-area');
        
        textArea.style.color = 'black'; // Ajouter cette ligne pour définir la couleur du texte

        textArea.addEventListener('focus', function() {
            if (this.textContent === this.getAttribute('placeholder')) {
                this.textContent = '';
                this.style.color = 'inherit';
            }
        });

        textArea.addEventListener('blur', function() {
            if (this.textContent === '') {
                this.textContent = this.getAttribute('placeholder');
                this.style.color = '#999';
            }
        });

        // Initialiser le placeholder
        if (textArea.textContent === '') {
            textArea.textContent = textArea.getAttribute('placeholder');
            textArea.style.color = '#999';
        }

        // Fonction pour charger la clé API au démarrage
        function loadApiKey() {
            const savedApiKey = localStorage.getItem('openaiApiKey');
            if (savedApiKey) {
                document.getElementById('apiKey').value = savedApiKey;
            }
        }

        // Appelez cette fonction au chargement de la page
        window.onload = function() {
            loadApiKey();
            loadSettings();
        };

        // Fonction pour ajouter les effets de survol
        function addHoverEffects() {
            const buttons = document.querySelectorAll('.side-button');
            
            buttons.forEach(button => {
                button.addEventListener('mouseenter', () => {
                    button.classList.add('hovered');
                });
                
                button.addEventListener('mouseleave', () => {
                    button.classList.remove('hovered');
                });
            });
        }

        // Appeler la fonction lorsque le DOM est chargé
        document.addEventListener('DOMContentLoaded', addHoverEffects);

        async function generatePlaceholderExamples() {
            const apiKey = localStorage.getItem('openaiApiKey');
            const jobTitle = localStorage.getItem('userJobTitle') || 'professionnel';
            const userBackground = localStorage.getItem('userBackground') || 'Pas de contexte fourni';
            const language = localStorage.getItem('userLanguage') || 'français';
            
            const textArea = document.getElementById('text-area');
            
            textArea.setAttribute('placeholder', 'Veuillez patienter...');

            const prompt = `En tant que ${jobTitle} avec le contexte suivant : "${userBackground}", 
            générez 3 exemples courts de thèmes pour des posts LinkedIn. 
            Chaque exemple doit être sur une ligne différente et ne pas dépasser 10 mots.
            Répondez en ${language}.`;

            try {
                const response = await fetch('https://api.openai.com/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${apiKey}`
                    },
                    body: JSON.stringify({
                        model: "gpt-3.5-turbo",
                        messages: [
                            {role: "system", content: "Vous êtes un assistant spécialisé dans la cration de contenu LinkedIn."},
                            {role: "user", content: prompt}
                        ]
                    })
                });

                const data = await response.json();
                if (data.choices && data.choices.length > 0) {
                    const examples = data.choices[0].message.content.split('\n').filter(line => line.trim() !== '');
                    const placeholderText = `Écrivez votre thème ici, par exemple :\n${examples.join('\n')}`;
                    textArea.setAttribute('placeholder', placeholderText);
                    if (textArea.textContent.trim() === 'Veuillez patienter...') {
                        textArea.textContent = '';
                        textArea.setAttribute('data-placeholder-active', 'true');
                        updatePlaceholderVisibility();
                    }
                }
            } catch (error) {
                console.error('Erreur lors de la génération des exemples:', error);
                textArea.setAttribute('placeholder', 'Erreur lors de la génération des exemples. Veuillez réessayer.');
            }
        }

        function setupPlaceholder() {
            const textArea = document.getElementById('text-area');
            
            textArea.addEventListener('focus', function() {
                if (this.getAttribute('data-placeholder-active') === 'true') {
                    this.textContent = '';
                    this.classList.remove('placeholder-active');
                    this.setAttribute('data-placeholder-active', 'false');
                }
            });

            textArea.addEventListener('blur', function() {
                if (this.textContent.trim() === '') {
                    this.setAttribute('data-placeholder-active', 'true');
                    updatePlaceholderVisibility();
                }
            });

            textArea.addEventListener('input', function() {
                if (this.textContent.trim() !== '') {
                    this.classList.remove('placeholder-active');
                }
                updatePlaceholderVisibility();
            });
        }

        function updatePlaceholderVisibility() {
            const textArea = document.getElementById('text-area');
            if (textArea.getAttribute('data-placeholder-active') === 'true' && textArea.textContent.trim() === '') {
                textArea.textContent = textArea.getAttribute('placeholder');
                textArea.classList.add('placeholder-active');
            } else {
                textArea.classList.remove('placeholder-active');
            }
        }

        function updatePlaceholder(placeholderText) {
            const textArea = document.getElementById('text-area');
            if (placeholderText) {
                textArea.setAttribute('placeholder', placeholderText);
            }
            if (textArea.textContent.trim() === '') {
                textArea.textContent = textArea.getAttribute('placeholder');
                textArea.classList.add('placeholder-active');
                textArea.setAttribute('data-placeholder-active', 'true');
            }
        }

        // Fonction d'initialisation
        async function initialize() {
            loadSettings();
            setupPlaceholder();
            const textArea = document.getElementById('text-area');
            textArea.textContent = 'Veuillez patienter...';
            textArea.style.color = '#999';
            await generatePlaceholderExamples();
            updatePlaceholderVisibility();
            updateButtonLabels();

            // Vérifier si la clé API OpenAI est définie
            const apiKey = localStorage.getItem('openaiApiKey');
            if (!apiKey) {
                openSettings();
            }
        }

        // Appeler la fonction d'initialisation lorsque le DOM est chargé
        document.addEventListener('DOMContentLoaded', initialize);

        document.addEventListener('DOMContentLoaded', (event) => {
            const textArea = document.getElementById('text-area');
            const imagePreview = document.getElementById('image-preview');

            textArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                e.stopPropagation();
            });

            textArea.addEventListener('drop', (e) => {
                e.preventDefault();
                e.stopPropagation();

                const files = e.dataTransfer.files;
                if (files.length > 0 && files[0].type.startsWith('image/')) {
                    handleImage(files[0]);
                }
            });

            function handleImage(file) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    const img = document.createElement('img');
                    img.src = e.target.result;
                    imagePreview.innerHTML = '';
                    imagePreview.appendChild(img);
                    imagePreview.style.display = 'block';
                };
                reader.readAsDataURL(file);

                // Ici, vous pouvez ajouter le code pour uploader l'image vers votre serveur
                // uploadImage(file);
            }

            // Fonction pour uploader l'image (à implémenter selon votre backend)
            // function uploadImage(file) {
            //     const formData = new FormData();
            //     formData.append('image', file);
            //     
            //     fetch('/upload-image', {
            //         method: 'POST',
            //         body: formData
            //     })
            //     .then(response => response.json())
            //     .then(data => console.log('Image uploaded:', data))
            //     .catch(error => console.error('Error uploading image:', error));
            // }
        });

        // Ajoutez cette fonction à la fin de votre script
        document.addEventListener('DOMContentLoaded', function() {
    const regenerateButton = document.getElementById('regenerate-image');
    if (regenerateButton) {
        regenerateButton.addEventListener('click', async function() {
            const icon = regenerateButton.querySelector('.regenerate-icon');
            icon.classList.add('spinning');
            
            try {
                const textArea = document.getElementById('text-area');
                const postContent = textArea.textContent;
                const imagePrompt = await generateImagePrompt(postContent);
                await generateImage(imagePrompt);
            } finally {
                icon.classList.remove('spinning');
            }
        });
            }
        });

        // Dans votre fichier JavaScript
        // Fonction pour utiliser la clé API
        async function useOpenAI(prompt) {
            try {
                const response = await fetch('https://api.openai.com/v1/engines/davinci-codex/completions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${openaiApiKey}`
                    },
                    body: JSON.stringify({
                        prompt: prompt,
                        max_tokens: 100
                    })
                });
                const data = await response.json();
                return data.choices[0].text;
            } catch (error) {
                console.error('Erreur lors de l\'appel à OpenAI:', error);
            }
        }

        // Exemple d'utilisation
        useOpenAI("Écris un post LinkedIn sur l'intelligence artificielle").then(result => {
            console.log(result);
        });

        document.addEventListener('DOMContentLoaded', function() {
            const textArea = document.getElementById('text-area');
            const shareButton = document.getElementById('shareToLinkedIn');
            
            textArea.addEventListener('input', updateShareButtonState);
            textArea.addEventListener('blur', updateShareButtonState);

            // Initialiser l'état du bouton au chargement de la page
            updateShareButtonState();

            // ... code existant pour le bouton de partage ...
        });

        // Assurez-vous que le bouton est caché au chargement de la page
        document.addEventListener('DOMContentLoaded', function() {
            const shareButton = document.getElementById('shareToLinkedIn');
            shareButton.style.display = 'none';
            
            // ... autres initialisations si nécessaire ...
        });

        document.getElementById('openSettings').addEventListener('click', function(e) {
            e.preventDefault();
            openSettings();
        });

        function setTheme(theme) {
            if (theme === 'dark') {
                document.body.classList.add('dark-mode');
                localStorage.setItem('theme', 'dark');
            } else {
                document.body.classList.remove('dark-mode');
                localStorage.setItem('theme', 'light');
            }
        }

        function loadTheme() {
            const savedTheme = localStorage.getItem('theme') || 'light';
            setTheme(savedTheme);
        }

        document.addEventListener('DOMContentLoaded', loadTheme);

        document.getElementById('shareToLinkedIn').addEventListener('click', function() {
            const textArea = document.getElementById('text-area');
            const postContent = textArea.textContent; // Utiliser textContent au lieu de innerHTML
            
            // Ouvrir LinkedIn dans un nouvel onglet
            window.open('https://www.linkedin.com/feed/', '_blank');
            
            // Copier le contenu dans le presse-papier
            navigator.clipboard.writeText(postContent)
                .then(() => {
                    alert('Le texte a été copié dans votre presse-papier.\nCollez-le dans le composeur de post LinkedIn qui vient de s\'ouvrir.');
                })
                .catch(err => {
                    console.error('Erreur lors de la copie :', err);
                    alert('Erreur lors de la copie du texte');
                });
        });

        // Ajout des fonctions de contrôle de fenêtre
        function closeWindow() {
            window.close();
        }

        function minimizeWindow() {
            require('electron').remote.getCurrentWindow().minimize();
        }

        function maximizeWindow() {
            const win = require('electron').remote.getCurrentWindow();
            if (win.isMaximized()) {
                win.unmaximize();
            } else {
                win.maximize();
            }
        }

        // Fonction pour générer une image à partir du post
        async function generateImageFromPost() {
            const generateImgButton = document.querySelector('.style-button.generate-img');
            try {
                const textArea = document.getElementById('text-area');
                const postContent = textArea.textContent;
                
                if (!postContent.trim()) {
                    alert('Veuillez d\'abord générer un post avant de créer une image.');
                    return;
                }
                
                if (generateImgButton) {
                    generateImgButton.disabled = true;
                    generateImgButton.textContent = 'Génération en cours...';
                }
                
                const imagePrompt = await generateImagePrompt(postContent);
                await generateImage(imagePrompt);
                
                // Afficher l'image générée
                const generatedImage = document.getElementById('generated-image');
                if (generatedImage) {
                    generatedImage.style.display = 'block';
                }
                
                // Afficher le bouton de régénération
                const regenerateButton = document.getElementById('regenerate-image');
                if (regenerateButton) {
                    regenerateButton.style.display = 'block';
                }
                
                // Changer le bouton "Générer une image" en "Télécharger l'image"
                if (generateImgButton) {
                    generateImgButton.textContent = 'Télécharger l\'image';
                    generateImgButton.onclick = downloadGeneratedImage;
                }
            } catch (error) {
                console.error('Erreur lors de la génération de l\'image:', error);
                alert(`Une erreur s'est produite lors de la génération de l'image: ${error.message}`);
            } finally {
                if (generateImgButton) {
                    generateImgButton.disabled = false;
                }
            }
        }

        // Fonction pour télécharger l'image générée
        function downloadGeneratedImage() {
            const generatedImage = document.getElementById('generated-image');
            if (generatedImage && generatedImage.src) {
                // Créer un lien temporaire pour le téléchargement
                const downloadLink = document.createElement('a');
                downloadLink.href = generatedImage.src;
                downloadLink.download = 'writly-image.png';
                document.body.appendChild(downloadLink);
                downloadLink.click();
                document.body.removeChild(downloadLink);
            } else {
                alert('Aucune image n\'est disponible pour le téléchargement.');
            }
        }

        // Fonction pour générer un prompt pour DALL-E à partir du contenu du post
        async function generateImagePrompt(postContent) {
            try {
                const apiKey = localStorage.getItem('openaiApiKey');
                if (!apiKey) {
                    throw new Error('Clé API OpenAI non définie');
                }

                // Récupérer le style d'image choisi
                const imageStyleSelect = document.getElementById('imageStyle');
                const imageStyle = imageStyleSelect.value;
                let styleDescription = '';
                
                if (imageStyle === 'custom') {
                    const customPrompt = document.getElementById('customPrompt').value.trim();
                    if (!customPrompt) {
                        throw new Error('Veuillez entrer un prompt personnalisé');
                    }
                    styleDescription = customPrompt;
                } else {
                    switch(imageStyle) {
                        case 'cartoon_3d':
                            styleDescription = 'style cartoon 3D avec des couleurs vives';
                            break;
                        case 'realistic':
                            styleDescription = 'style réaliste avec des détails précis';
                            break;
                        case 'digital_art':
                            styleDescription = 'style art digital moderne';
                            break;
                        case 'watercolor':
                            styleDescription = 'style aquarelle avec des couleurs douces et des transitions fluides';
                            break;
                        case 'oil_painting':
                            styleDescription = 'style peinture à l\'huile avec texture et profondeur';
                            break;
                        case 'minimalist':
                            styleDescription = 'style minimaliste avec des lignes épurées et peu de détails';
                            break;
                        case 'studio_ghibli':
                            styleDescription = 'style Studio Ghibli, animation japonaise douce et poétique';
                            break;
                        case 'pixar':
                            styleDescription = 'style Pixar avec des expressions caricaturales expressives';
                            break;
                        case 'coloring_book':
                            styleDescription = 'style livre de coloriage pour enfants avec des contours nets';
                            break;
                        case 'isometric':
                            styleDescription = 'style scène isométrique 3D avec perspective géométrique';
                            break;
                        case 'comic_strip':
                            styleDescription = 'style bande dessinée avec cases et bulles de dialogue';
                            break;
                        case 'graffiti':
                            styleDescription = 'style art urbain graffiti avec des couleurs vives et des effets de spray';
                            break;
                        default:
                            styleDescription = 'style moderne et professionnel';
                    }
                }

                // Afficher un message de progression
                console.log('Génération du prompt pour DALL-E...');
                
                // Appel à l'API GPT pour générer un prompt adapté à DALL-E
                const response = await fetch('https://api.openai.com/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${apiKey}`
                    },
                    body: JSON.stringify({
                        model: 'gpt-4o',
                        messages: [
                            {
                                role: 'system',
                                content: `Tu es un expert en création de prompts pour DALL-E. 
                                Tu dois créer un prompt détaillé et précis pour générer une image dans un ${styleDescription} qui illustre parfaitement le contenu du post LinkedIn fourni.
                                Le prompt doit être en anglais, concis mais descriptif, et inclure des détails sur:
                                - Le sujet principal à illustrer
                                - Le ${styleDescription}
                                - L'ambiance et l'émotion à transmettre
                                - Des détails visuels spécifiques qui renforcent le message
                                - Une composition claire et professionnelle
                                Ne commence pas par "Prompt:" ou autre introduction, donne directement le prompt.
                                Limite-toi à 75 mots maximum.`
                            },
                            {
                                role: 'user',
                                content: `Voici le post LinkedIn pour lequel je souhaite une illustration en ${styleDescription}: "${postContent}"`
                            }
                        ],
                        max_tokens: 300,
                        temperature: 0.7
                    })
                });

                if (!response.ok) {
                    throw new Error(`Erreur API: ${response.status}`);
                }

                const data = await response.json();
                const prompt = data.choices[0].message.content.trim();
                
                console.log('Prompt généré:', prompt);
                return prompt;
            } catch (error) {
                console.error('Erreur lors de la génération du prompt:', error);
                throw error;
            }
        }

        // Fonction pour générer une image avec DALL-E
        async function generateImage(prompt) {
            try {
                const apiKey = localStorage.getItem('openaiApiKey');
                if (!apiKey) {
                    throw new Error('Clé API OpenAI non définie');
                }

                // Récupérer le style d'image choisi
                const imageStyle = localStorage.getItem('imageStyle') || 'cartoon_3d';
                let stylePrompt = '';
                
                switch(imageStyle) {
                    case 'cartoon_3d':
                        stylePrompt = "Style: 3D cartoon with vibrant colors, professional look, clean background.";
                        break;
                    case 'realistic':
                        stylePrompt = "Style: Realistic photography with natural lighting, high detail, professional composition.";
                        break;
                    case 'digital_art':
                        stylePrompt = "Style: Modern digital art with vibrant colors, dynamic composition, professional finish.";
                        break;
                    case 'watercolor':
                        stylePrompt = "Style: Soft watercolor painting with gentle color transitions, artistic feel, light texture.";
                        break;
                    case 'oil_painting':
                        stylePrompt = "Style: Oil painting with rich textures, depth, classical composition, artistic brushstrokes.";
                        break;
                    case 'minimalist':
                        stylePrompt = "Style: Minimalist design with clean lines, limited color palette, simple shapes, elegant composition.";
                        break;
                    case 'isometric':
                        stylePrompt = "Style: Isometric 3D design with geometric perspective, clean lines, professional look.";
                        break;
                    case 'flat_design':
                        stylePrompt = "Style: Flat design with bold colors, no shadows, clean composition, modern look.";
                        break;
                    case 'pixel_art':
                        stylePrompt = "Style: Retro pixel art with limited color palette, visible pixels, nostalgic gaming aesthetic.";
                        break;
                    case 'comic_book':
                        stylePrompt = "Style: Comic book illustration with bold outlines, vibrant colors, dynamic composition.";
                        break;
                    default:
                        stylePrompt = "Style: 3D cartoon with vibrant colors, professional look, clean background.";
                }

                // Afficher un message de progression
                console.log('Génération de l\'image avec DALL-E...');
                
                // Appel à l'API DALL-E pour générer l'image
                const response = await fetch('https://api.openai.com/v1/images/generations', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${apiKey}`
                    },
                    body: JSON.stringify({
                        model: 'dall-e-3',
                        prompt: prompt + " " + stylePrompt,
                        n: 1,
                        size: '1024x1024',
                        quality: 'standard'
                    })
                });

                if (!response.ok) {
                    throw new Error(`Erreur API: ${response.status}`);
                }

                const data = await response.json();
                const imageUrl = data.data[0].url;
                
                // Mettre à jour l'image générée
                const imagePreview = document.getElementById('image-preview');
                const generatedImage = document.getElementById('generated-image');
                const regenerateButton = document.getElementById('regenerate-image');
                
                if (generatedImage && imagePreview && regenerateButton) {
                    generatedImage.src = imageUrl;
                    imagePreview.style.display = 'flex';
                    generatedImage.style.display = 'block';
                    regenerateButton.style.display = 'block';
                } else {
                    throw new Error('Éléments d\'interface non trouvés');
                }
                
                console.log('Image générée avec succès');
                return imageUrl;
            } catch (error) {
                console.error('Erreur lors de la génération de l\'image:', error);
                throw error;
            }
        }

        // Fonction pour basculer l'affichage du texte (tronqué/complet)
        function toggleTextCollapse() {
            const textArea = document.getElementById('text-area');
            if (!textArea) return;
            
            if (textArea.classList.contains('text-collapsed')) {
                // Afficher le texte complet
                textArea.classList.remove('text-collapsed');
                
                // Restaurer le texte complet s'il a été sauvegardé
                if (textArea.dataset.fullText) {
                    textArea.textContent = textArea.dataset.fullText;
                }
                
                const readMoreBtn = document.querySelector('.read-more-btn');
                if (readMoreBtn) {
                    readMoreBtn.remove();
                }
            } else {
                // Sauvegarder le texte complet
                textArea.dataset.fullText = textArea.textContent;
                
                // Appliquer la classe pour limiter à 3 lignes
                textArea.classList.add('text-collapsed');
                
                // Ajouter le bouton "... plus"
                if (!document.querySelector('.read-more-btn')) {
                    const readMoreBtn = document.createElement('span');
                    readMoreBtn.className = 'read-more-btn';
                    readMoreBtn.textContent = '... plus';
                    readMoreBtn.onclick = function(e) {
                        e.stopPropagation();
                        toggleTextCollapse();
                    };
                    textArea.parentNode.insertBefore(readMoreBtn, textArea.nextSibling);
                }
            }
        }

        // Fonction pour traduire le post en anglais
        async function translateToEnglish() {
            try {
                const textArea = document.getElementById('text-area');
                const postContent = textArea.textContent;
                
                if (!postContent.trim()) {
                    alert('Veuillez d\'abord générer un post avant de le traduire.');
                    return;
                }
                
                const translateButton = document.querySelector('.style-button.translate');
                if (translateButton) {
                    translateButton.disabled = true;
                    translateButton.textContent = 'Traduction en cours...';
                }
                
                // Afficher la barre de progression
                const progressBarContainer = document.querySelector('.progress-bar-container');
                const progressBar = document.querySelector('.progress-bar');
                
                let progressInterval;
                
                if (progressBarContainer && progressBar) {
                    progressBarContainer.style.display = 'block';
                    progressBar.style.width = '0%';
                    
                    // Simuler une progression pour la traduction
                    let progress = 0;
                    progressInterval = setInterval(() => {
                        progress += 5;
                        if (progress > 90) {
                            clearInterval(progressInterval);
                        }
                        progressBar.style.width = `${progress}%`;
                    }, 100);
                }
                
                const apiKey = localStorage.getItem('openaiApiKey');
                if (!apiKey) {
                    throw new Error('Clé API OpenAI non définie');
                }
                
                // Appel à l'API GPT pour traduire le texte
                const response = await fetch('https://api.openai.com/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${apiKey}`
                    },
                    body: JSON.stringify({
                        model: 'gpt-4o',
                        messages: [
                            {
                                role: 'system',
                                content: `Tu es un traducteur professionnel français-anglais spécialisé dans les posts LinkedIn. 
                                Traduis le texte fourni en anglais en conservant le ton, le style et le format du message original.
                                Assure-toi que la traduction soit naturelle et professionnelle, adaptée au contexte des réseaux sociaux professionnels.
                                Ne commente pas la traduction, renvoie uniquement le texte traduit.`
                            },
                            {
                                role: 'user',
                                content: `Voici le post LinkedIn à traduire en anglais: "${postContent}"`
                            }
                        ],
                        max_tokens: 1000,
                        temperature: 0.7
                    })
                });
                
                if (!response.ok) {
                    throw new Error(`Erreur API: ${response.status}`);
                }
                
                const data = await response.json();
                let translatedText = data.choices[0].message.content.trim();
                
                // Nettoyer le texte traduit pour supprimer "éativité" ou tout autre texte indésirable à la fin
                translatedText = translatedText.replace(/éativité\s*$/i, '');
                
                // Mettre à jour le contenu du post avec la traduction
                textArea.textContent = translatedText;
                
                // Arrêter la simulation de progression et compléter la barre
                if (progressBarContainer && progressBar) {
                    clearInterval(progressInterval);
                    progressBar.style.width = '100%';
                    
                    // Cacher la barre de progression après un court délai
                    setTimeout(() => {
                        progressBarContainer.style.display = 'none';
                        progressBar.style.width = '0%';
                    }, 500);
                }
                
                console.log('Traduction terminée avec succès');
            } catch (error) {
                console.error('Erreur lors de la traduction:', error);
                alert(`Une erreur s'est produite lors de la traduction: ${error.message}`);
            } finally {
                const translateButton = document.querySelector('.style-button.translate');
                if (translateButton) {
                    translateButton.disabled = false;
                    translateButton.textContent = 'Traduire en anglais';
                }
            }
        }

        function toggleTheme() {
            const isDarkMode = document.body.classList.toggle('dark-mode');
            localStorage.setItem('theme', isDarkMode ? 'dark' : 'light');
            
            // Changer l'icône visible
            const lightIcon = document.querySelector('.light-icon');
            const darkIcon = document.querySelector('.dark-icon');
            
            if (isDarkMode) {
                lightIcon.style.display = 'none';
                darkIcon.style.display = 'block';
            } else {
                lightIcon.style.display = 'block';
                darkIcon.style.display = 'none';
            }
        }

        function loadTheme() {
            const savedTheme = localStorage.getItem('theme') || 'light';
            setTheme(savedTheme);
            
            // Mettre à jour l'icône visible
            const lightIcon = document.querySelector('.light-icon');
            const darkIcon = document.querySelector('.dark-icon');
            
            if (savedTheme === 'dark') {
                lightIcon.style.display = 'none';
                darkIcon.style.display = 'block';
            } else {
                lightIcon.style.display = 'block';
                darkIcon.style.display = 'none';
            }
        }

        // Fonction pour régénérer l'image
        async function regenerateImage() {
            const regenerateButton = document.getElementById('regenerate-image');
            const generatedImage = document.getElementById('generated-image');
            
            try {
                regenerateButton.classList.add('loading');
                
                // Récupérer le contenu du post
                const textArea = document.getElementById('text-area');
                const postContent = textArea.textContent;
                
                // Générer une nouvelle image
                const imagePrompt = await generateImagePrompt(postContent);
                await generateImage(imagePrompt);
                
                // Animation de succès
                regenerateButton.classList.remove('loading');
                regenerateButton.classList.add('regenerating');
                setTimeout(() => {
                    regenerateButton.classList.remove('regenerating');
                }, 1000);
                
            } catch (error) {
                console.error('Erreur lors de la régénération:', error);
                alert('Une erreur est survenue lors de la régénération de l\'image');
                regenerateButton.classList.remove('loading');
            }
        }

    </script>
</body>
</html>

